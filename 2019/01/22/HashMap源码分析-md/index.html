<!DOCTYPE html>


  <html class="dark page-post">


<head>
  <meta charset="utf-8">
  <meta name="referrer" content="no-referrer" />
  
  <title>HashMapæºç åˆ†æ | MurasakiSeiFu</title>

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
    <meta name="keywords" content="java,redis,nginx,zookeeper,åˆ†å¸ƒå¼ä¸­é—´ä»¶,å¾®æœåŠ¡,springboot,mysql" />
  

  <meta name="description" content="Map æºç åˆ†æHashMap&amp;amp;HashTable&amp;amp;ConcurrentHashMapHashMapé¦–å…ˆæˆ‘ä»¬çœ‹ä¸€ä¸‹HashMapç±»çš„é™æ€å±æ€§ã€‚ 12345678910111213141516171819202122232425262728293031323334353637public class HashMap&amp;lt;K,V&amp;gt; extends AbstractMap&amp;l">
<meta property="og:type" content="article">
<meta property="og:title" content="HashMapæºç åˆ†æ">
<meta property="og:url" content="http://ilovenorth.life/2019/01/22/HashMapæºç åˆ†æ-md/index.html">
<meta property="og:site_name" content="MurasakiSeiFu">
<meta property="og:description" content="Map æºç åˆ†æHashMap&amp;amp;HashTable&amp;amp;ConcurrentHashMapHashMapé¦–å…ˆæˆ‘ä»¬çœ‹ä¸€ä¸‹HashMapç±»çš„é™æ€å±æ€§ã€‚ 12345678910111213141516171819202122232425262728293031323334353637public class HashMap&amp;lt;K,V&amp;gt; extends AbstractMap&amp;l">
<meta property="og:locale" content="default">
<meta property="og:image" content="https://ws1.sinaimg.cn/large/006tNc79ly1fz9fvpuiw9j319u0niac9.jpg">
<meta property="og:image" content="https://ws2.sinaimg.cn/large/006tNc79ly1fzar66rfkej311v0u07cj.jpg">
<meta property="og:image" content="https://ws1.sinaimg.cn/large/006tNc79ly1fzfbg2rw5sj311m0iqgul.jpg">
<meta property="og:updated_time" content="2019-04-28T06:48:51.448Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="HashMapæºç åˆ†æ">
<meta name="twitter:description" content="Map æºç åˆ†æHashMap&amp;amp;HashTable&amp;amp;ConcurrentHashMapHashMapé¦–å…ˆæˆ‘ä»¬çœ‹ä¸€ä¸‹HashMapç±»çš„é™æ€å±æ€§ã€‚ 12345678910111213141516171819202122232425262728293031323334353637public class HashMap&amp;lt;K,V&amp;gt; extends AbstractMap&amp;l">
<meta name="twitter:image" content="https://ws1.sinaimg.cn/large/006tNc79ly1fz9fvpuiw9j319u0niac9.jpg">

  

  
    <link rel="icon" href="/images/favicon.ico">
  

  <link href="/css/styles.css?v=c114cbeddx" rel="stylesheet">


  
    <link rel="stylesheet" href="/css/personal-style.css">
  

  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-86660611-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


  
  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?2e6da3c375c8a87f5b664cea6d4cb29c";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>


  
  <script type="text/javascript">
	(function(){
	    var bp = document.createElement('script');
	    var curProtocol = window.location.protocol.split(':')[0];
	    if (curProtocol === 'https') {
	        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
	    }
	    else {
	        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
	    }
	    var s = document.getElementsByTagName("script")[0];
	    s.parentNode.insertBefore(bp, s);
	})();
  </script>



  
    <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.3.0/css/font-awesome.min.css">
  

</head>

<body>


  
    <span id="toolbox-mobile" class="toolbox-mobile">ğŸ†</span>
  

  <div class="post-header CENTER">
   
  <div class="toolbox">
    <a class="toolbox-entry" href="/">
      <span class="toolbox-entry-text">ğŸ†</span>
      <i class="icon-angle-down"></i>
      <i class="icon-home"></i>
    </a>
    <ul class="list-toolbox">
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/archives/"
            rel="noopener noreferrer"
            target="_self"
            >
            åšå®¢
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/categories/"
            rel="noopener noreferrer"
            target="_self"
            >
            åˆ†ç±»
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/tag/"
            rel="noopener noreferrer"
            target="_self"
            >
            æ ‡ç­¾
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/link/"
            rel="noopener noreferrer"
            target="_self"
            >
            å‹é“¾
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/about/"
            rel="noopener noreferrer"
            target="_self"
            >
            å…³äº
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/atom.xml"
            rel="noopener noreferrer"
            target="_blank"
            >
            RSS
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/search/"
            rel="noopener noreferrer"
            target="_self"
            >
            æœç´¢
          </a>
        </li>
      
    </ul>
  </div>


</div>


  <div id="toc" class="toc-article">
    <strong class="toc-title">Posts List</strong>
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Map-æºç åˆ†æ"><span class="toc-text">Map æºç åˆ†æ</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#HashMap-amp-HashTable-amp-ConcurrentHashMap"><span class="toc-text">HashMap&amp;HashTable&amp;ConcurrentHashMap</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HashMap"><span class="toc-text">HashMap</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#çº¢é»‘æ ‘"><span class="toc-text">çº¢é»‘æ ‘</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HashMap-å·¥ä½œåŸç†"><span class="toc-text">HashMap å·¥ä½œåŸç†</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#HashMap-putæ–¹æ³•åˆ†æ"><span class="toc-text">HashMap putæ–¹æ³•åˆ†æ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HashMap-getæ–¹æ³•åˆ†æ"><span class="toc-text">HashMap getæ–¹æ³•åˆ†æ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#å‡å°‘hashç¢°æ’"><span class="toc-text">å‡å°‘hashç¢°æ’</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HashMapæ‰©å®¹æ–¹æ³•-resize"><span class="toc-text">HashMapæ‰©å®¹æ–¹æ³• resize()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HashMap-hashå‡½æ•°å®ç°"><span class="toc-text">HashMap hashå‡½æ•°å®ç°</span></a></li></ol></li></ol></li></ol></li></ol>
  </div>



<div class="content content-post CENTER">
   <article id="post-HashMapæºç åˆ†æ-md" class="article article-type-post" itemprop="blogPost">
  <header class="article-header">
    <h1 class="post-title">HashMapæºç åˆ†æ</h1>

    <div class="article-meta">
      <span>
        <i class="icon-calendar"></i>
        <span>2019.01.22</span>
      </span>

      
        <span class="article-author">
          <i class="icon-user"></i>
          <span>MurasakiSeiFu.</span>
        </span>
      

      
  <span class="article-category">
    <i class="icon-list"></i>
    <a class="article-category-link" href="/categories/æºç åˆ†æ/">æºç åˆ†æ</a>
  </span>



      

      
      <i class="fa fa-eye"></i> 
        <span id="busuanzi_container_page_pv">
           &nbspçƒ­åº¦ <span id="busuanzi_value_page_pv">
           <i class="fa fa-spinner fa-spin"></i></span>â„ƒ
        </span>
      
      
    </div>
  </header>

  <div class="article-content">
    
      <meta name="referrer" content="no-referrer">

<h1 id="Map-æºç åˆ†æ"><a href="#Map-æºç åˆ†æ" class="headerlink" title="Map æºç åˆ†æ"></a>Map æºç åˆ†æ</h1><h2 id="HashMap-amp-HashTable-amp-ConcurrentHashMap"><a href="#HashMap-amp-HashTable-amp-ConcurrentHashMap" class="headerlink" title="HashMap&amp;HashTable&amp;ConcurrentHashMap"></a>HashMap&amp;HashTable&amp;ConcurrentHashMap</h2><h2 id="HashMap"><a href="#HashMap" class="headerlink" title="HashMap"></a>HashMap</h2><p><strong>é¦–å…ˆæˆ‘ä»¬çœ‹ä¸€ä¸‹HashMapç±»çš„é™æ€å±æ€§ã€‚</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HashMap</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt; <span class="keyword">extends</span> <span class="title">AbstractMap</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt;</span></span><br><span class="line"><span class="class">    <span class="keyword">implements</span> <span class="title">Map</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt;, <span class="title">Cloneable</span>, <span class="title">Serializable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">362498820763181265L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é»˜è®¤åˆå§‹å®¹é‡ - å¿…é¡»æ˜¯2çš„å¹‚ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> DEFAULT_INITIAL_CAPACITY = <span class="number">1</span> &lt;&lt; <span class="number">4</span>; <span class="comment">// aka 16</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æœ€å¤§å®¹é‡ä¸º2çš„30æ¬¡å¹‚ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> MAXIMUM_CAPACITY = <span class="number">1</span> &lt;&lt; <span class="number">30</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¦‚æœæ„é€ å‡½æ•°ä¸­æ²¡æœ‰æŒ‡å®šï¼Œåˆ™ä½¿ç”¨è¯¥é»˜è®¤çš„åŠ è½½å› å­ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">float</span> DEFAULT_LOAD_FACTOR = <span class="number">0.75f</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¦‚æœä¸€ä¸ªæ¡¶ä¸­çš„å…ƒç´ ä¸ªæ•°è¶…è¿‡ TREEIFY_THRESHOLD(é»˜è®¤æ˜¯ 8 )ï¼Œå°±ä½¿ç”¨çº¢é»‘æ ‘æ¥æ›¿æ¢é“¾è¡¨</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> TREEIFY_THRESHOLD = <span class="number">8</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸€ä¸ªæ ‘çš„é“¾è¡¨è¿˜åŸé˜ˆå€¼ï¼Œå½“æ‰©å®¹æ—¶ï¼Œæ¡¶ä¸­å…ƒç´ ä¸ªæ•°å°äºè¿™ä¸ªå€¼,å°±ä¼šæŠŠæ ‘å½¢çš„æ¡¶å…ƒç´ è¿˜åŸï¼ˆåˆ‡åˆ†ï¼‰ä¸ºé“¾è¡¨ç»“æ„</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> UNTREEIFY_THRESHOLD = <span class="number">6</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å“ˆå¸Œè¡¨çš„æœ€å°æ ‘å½¢åŒ–å®¹é‡</span></span><br><span class="line"><span class="comment">	 * å½“å“ˆå¸Œè¡¨ä¸­çš„å®¹é‡å¤§äºè¿™ä¸ªå€¼æ—¶ï¼Œè¡¨ä¸­çš„æ¡¶æ‰èƒ½è¿›è¡Œæ ‘å½¢åŒ–</span></span><br><span class="line"><span class="comment">	 * å¦åˆ™æ¡¶å†…å…ƒç´ å¤ªå¤šæ—¶ä¼šæ‰©å®¹ï¼Œè€Œä¸æ˜¯æ ‘å½¢åŒ–</span></span><br><span class="line"><span class="comment">	 * ä¸ºäº†é¿å…è¿›è¡Œæ‰©å®¹ã€æ ‘å½¢åŒ–é€‰æ‹©çš„å†²çªï¼Œè¿™ä¸ªå€¼ä¸èƒ½å°äº 4 * TREEIFY_THRESHOLD</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> MIN_TREEIFY_CAPACITY = <span class="number">64</span>;</span><br></pre></td></tr></table></figure>
<p>é€šè¿‡å±æ€§ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾—çŸ¥HashMapçš„åŸºç¡€ä¿¡æ¯ï¼š</p>
<ul>
<li>åˆå§‹åŒ–é»˜è®¤å¤§å°ä¸º16.</li>
<li>æœ€å¤§å®¹é‡ä¸º2çš„30æ¬¡å¹‚ã€‚</li>
<li>é»˜è®¤çš„æ‰©å®¹å¤åˆ¶å› å­ä¸º0.75.</li>
<li>JDK1.8ä¸­ï¼Œå½“ä¸€ä¸ªbucketçš„é“¾è¡¨å®¹é‡å¤§äº8æ—¶ï¼Œå°†é“¾è¡¨è½¬æ¢ä¸ºçº¢é»‘æ ‘ç»“æ„ã€‚</li>
<li>å½“ä¸€ä¸ªbucketçš„çº¢é»‘æ ‘ç»“æ„å®¹é‡å°äº6æ—¶ï¼Œå°†çº¢é»‘æ ‘ç»“æ„è½¬æ¢ä¸ºé“¾è¡¨ç»“æ„ã€‚</li>
</ul>
<p><strong>å†è®©æˆ‘ä»¬çœ‹çœ‹HashMapç±»çš„å­—æ®µã€‚</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* ---------------- Fields -------------- */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¯¥è¡¨åœ¨é¦–æ¬¡ä½¿ç”¨æ—¶åˆå§‹åŒ–ï¼Œå¹¶æ ¹æ®éœ€è¦è°ƒæ•´å¤§å°ã€‚åˆ†é…æ—¶ï¼Œé•¿åº¦å§‹ç»ˆä¸º2çš„å¹‚ã€‚</span></span><br><span class="line"><span class="comment">     * ä¿å­˜Node&lt;K,V&gt;èŠ‚ç‚¹çš„æ•°ç»„</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">transient</span> Node&lt;K,V&gt;[] table;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”±ã€€hashMap ä¸­ Node&lt;K,V&gt;ã€€èŠ‚ç‚¹æ„æˆçš„ set</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">transient</span> Set&lt;Map.Entry&lt;K,V&gt;&gt; entrySet;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®°å½• hashMap å½“å‰å­˜å‚¨çš„å…ƒç´ çš„æ•°é‡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">transient</span> <span class="keyword">int</span> size;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®°å½•ã€€hashMap å‘ç”Ÿç»“æ„æ€§å˜åŒ–çš„æ¬¡æ•°ï¼ˆæ³¨æ„ã€€value çš„è¦†ç›–ä¸å±äºç»“æ„æ€§å˜åŒ–ï¼‰</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">transient</span> <span class="keyword">int</span> modCount;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * thresholdçš„å€¼åº”ç­‰äº table.length * loadFactor, sizeè¶…è¿‡è¿™ä¸ªå€¼æ—¶è¿›è¡Œresize()æ‰©å®¹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">int</span> threshold;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®°å½• hashMap è£…è½½å› å­</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">float</span> loadFactor;</span><br></pre></td></tr></table></figure>
<p><strong>HashMap ç»“æ„ã€‚</strong></p>
<p><img src="https://ws1.sinaimg.cn/large/006tNc79ly1fz9fvpuiw9j319u0niac9.jpg" alt=""></p>
<p>HashMapåº•å±‚å°±æ˜¯ä¸€ä¸ªæ•°ç»„ç»“æ„ï¼Œæ•°ç»„ä¸­çš„æ¯ä¸€é¡¹åˆæ˜¯ä¸€ä¸ªé“¾è¡¨ã€‚å½“æ–°å»ºä¸€ä¸ªHashMapçš„æ—¶å€™ï¼Œå°±ä¼šåˆå§‹åŒ–ä¸€ä¸ªæ•°ç»„ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Node</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt; <span class="keyword">implements</span> <span class="title">Map</span>.<span class="title">Entry</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt; </span>&#123;</span><br><span class="line">       <span class="keyword">final</span> <span class="keyword">int</span> hash; <span class="comment">//hashå€¼</span></span><br><span class="line">       <span class="keyword">final</span> K key;    <span class="comment">//é”®</span></span><br><span class="line">       V value;        <span class="comment">//å€¼</span></span><br><span class="line">       Node&lt;K,V&gt; next; <span class="comment">//ç”¨äºæŒ‡å‘é“¾è¡¨çš„ä¸‹ä¸€å±‚ï¼ˆäº§ç”Ÿå†²çªï¼Œç”¨æ‹‰é“¾æ³•ï¼‰</span></span><br><span class="line"></span><br><span class="line">       Node(<span class="keyword">int</span> hash, K key, V value, Node&lt;K,V&gt; next) &#123;</span><br><span class="line">           <span class="keyword">this</span>.hash = hash;</span><br><span class="line">           <span class="keyword">this</span>.key = key;</span><br><span class="line">           <span class="keyword">this</span>.value = value;</span><br><span class="line">           <span class="keyword">this</span>.next = next;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> K <span class="title">getKey</span><span class="params">()</span>        </span>&#123; <span class="keyword">return</span> key; &#125;</span><br><span class="line">       <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> V <span class="title">getValue</span><span class="params">()</span>      </span>&#123; <span class="keyword">return</span> value; &#125;</span><br><span class="line">       <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> key + <span class="string">"="</span> + value; &#125;</span><br><span class="line"></span><br><span class="line">       <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">           <span class="keyword">return</span> Objects.hashCode(key) ^ Objects.hashCode(value);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> V <span class="title">setValue</span><span class="params">(V newValue)</span> </span>&#123;</span><br><span class="line">           V oldValue = value;</span><br><span class="line">           value = newValue;</span><br><span class="line">           <span class="keyword">return</span> oldValue;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">           <span class="keyword">if</span> (o == <span class="keyword">this</span>)</span><br><span class="line">               <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">           <span class="keyword">if</span> (o <span class="keyword">instanceof</span> Map.Entry) &#123;</span><br><span class="line">               Map.Entry&lt;?,?&gt; e = (Map.Entry&lt;?,?&gt;)o;</span><br><span class="line">               <span class="keyword">if</span> (Objects.equals(key, e.getKey()) &amp;&amp;</span><br><span class="line">                   Objects.equals(value, e.getValue()))</span><br><span class="line">                   <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">           &#125;</span><br><span class="line">           <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<p><strong>HashMap æ„é€ å‡½æ•°</strong></p>
<ul>
<li>æ„é€ å‡½æ•°1ï¼šæŒ‡å®šåˆå§‹å®¹é‡â€“&gt; initialCapacity å’Œ è£…è½½å› å­â€“&gt; loadFactor<ul>
<li>å¦‚æœinitialCapacityï¼ˆåˆå§‹å®¹é‡ï¼‰å°äº0ï¼Œåˆ™ä¼šæŠ›å‡º<font color="red">éæ³•å‚æ•°å¼‚å¸¸</font>.</li>
<li>å¦‚æœinitialCapacityï¼ˆåˆå§‹å®¹é‡ï¼‰å¤§äºæœ€å¤§å®¹é‡ï¼Œåˆ™å°†initialCapacityèµ‹å€¼ä¸ºæœ€å¤§å®¹é‡ã€‚</li>
<li>å¦‚æœloadFactorï¼ˆå¤åˆ¶å› å­ï¼‰å°äºç­‰äº0ï¼Œæˆ–è€…æ‰€è¡¨ç¤ºçš„å€¼æ˜¯NaNï¼Œåˆ™ä¼šæŠ›å‡º<font color="red">éæ³•å‚æ•°å¼‚å¸¸</font>.</li>
<li>tableSizeFor(initialCapacity)ã€€æ–¹æ³•ï¼šè¿”å›æœ€æ¥è¿‘initialCapacityçš„2çš„æ¬¡å¹‚çš„å€¼ï¼Œè‹¥æŒ‡å®šåˆå§‹å®¹é‡ä¸ºï¼™ï¼Œåˆ™å®é™… hashMap å®¹é‡ä¸º16ã€‚</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">HashMap</span><span class="params">(<span class="keyword">int</span> initialCapacity, <span class="keyword">float</span> loadFactor)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (initialCapacity &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"Illegal initial capacity: "</span> +</span><br><span class="line">                                           initialCapacity);</span><br><span class="line">    <span class="keyword">if</span> (initialCapacity &gt; MAXIMUM_CAPACITY)</span><br><span class="line">        initialCapacity = MAXIMUM_CAPACITY;</span><br><span class="line">    <span class="keyword">if</span> (loadFactor &lt;= <span class="number">0</span> || Float.isNaN(loadFactor))</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"Illegal load factor: "</span> +</span><br><span class="line">                                           loadFactor);</span><br><span class="line">    <span class="keyword">this</span>.loadFactor = loadFactor;</span><br><span class="line">    <span class="keyword">this</span>.threshold = tableSizeFor(initialCapacity);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> <span class="title">tableSizeFor</span><span class="params">(<span class="keyword">int</span> cap)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n = cap - <span class="number">1</span>;</span><br><span class="line">    n |= n &gt;&gt;&gt; <span class="number">1</span>;<span class="comment">// &gt;&gt;&gt; æ— ç¬¦å·å³ç§»</span></span><br><span class="line">    n |= n &gt;&gt;&gt; <span class="number">2</span>;</span><br><span class="line">    n |= n &gt;&gt;&gt; <span class="number">4</span>;</span><br><span class="line">    n |= n &gt;&gt;&gt; <span class="number">8</span>;</span><br><span class="line">    n |= n &gt;&gt;&gt; <span class="number">16</span>;</span><br><span class="line">    <span class="keyword">return</span> (n &lt; <span class="number">0</span>) ? <span class="number">1</span> : (n &gt;= MAXIMUM_CAPACITY) ? MAXIMUM_CAPACITY : n + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>æ„é€ å‡½æ•°2ï¼šä»…æŒ‡å®šåˆå§‹å®¹é‡ï¼Œè£…è½½å› å­çš„å€¼ä¸ºé»˜è®¤çš„0.75f</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">HashMap</span><span class="params">(<span class="keyword">int</span> initialCapacity)</span> </span>&#123;</span><br><span class="line">       <span class="keyword">this</span>(initialCapacity, DEFAULT_LOAD_FACTOR);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>æ„é€ å‡½æ•°3ï¼šæ‰€æœ‰å‚æ•°å‡é‡‡ç”¨é»˜è®¤å€¼</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">HashMap</span><span class="params">()</span> </span>&#123;</span><br><span class="line">       <span class="keyword">this</span>.loadFactor = DEFAULT_LOAD_FACTOR; <span class="comment">// all other fields defaulted</span></span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>æ„é€ å‡½æ•°4ï¼šä¼ å…¥ä¸€ä¸ªmap<ul>
<li>æ„é€ ä¸€ä¸ªæ–°çš„HashMapï¼Œå…¶æ˜ å°„ä¸æŒ‡å®šçš„Mapç›¸åŒã€‚HashMapæ˜¯ä½¿ç”¨é»˜è®¤åŠ è½½å› å­ï¼ˆ0.75ï¼‰åˆ›å»ºçš„ï¼Œåˆå§‹å®¹é‡è¶³ä»¥ä¿å­˜æŒ‡å®šMapä¸­çš„æ˜ å°„ã€‚</li>
<li>å¦‚æœå‚æ•°Mapä¸ºnullï¼Œåˆ™ä¼šæŠ›å‡º<font color="red">ç©ºæŒ‡é’ˆå¼‚å¸¸</font>ã€‚</li>
<li>æŒ‡å®šé»˜è®¤å› å­ä¸º0.75f    </li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">HashMap</span><span class="params">(Map&lt;? extends K, ? extends V&gt; m)</span> </span>&#123;</span><br><span class="line">       <span class="keyword">this</span>.loadFactor = DEFAULT_LOAD_FACTOR;</span><br><span class="line">       putMapEntries(m, <span class="keyword">false</span>);</span><br><span class="line">   &#125;</span><br><span class="line">   </span><br><span class="line">   <span class="function"><span class="keyword">final</span> <span class="keyword">void</span> <span class="title">putMapEntries</span><span class="params">(Map&lt;? extends K, ? extends V&gt; m, <span class="keyword">boolean</span> evict)</span> </span>&#123;</span><br><span class="line">       <span class="keyword">int</span> s = m.size();</span><br><span class="line">       <span class="keyword">if</span> (s &gt; <span class="number">0</span>) &#123;</span><br><span class="line">       	<span class="comment">//å¦‚æœæœ¬åœ°Node&lt;K,V&gt;[] tableä¸ºnull åˆ™æ ¹æ®Mapçš„sizeè¿›è¡Œåˆå§‹åŒ–ã€‚</span></span><br><span class="line">           <span class="keyword">if</span> (table == <span class="keyword">null</span>) &#123; <span class="comment">// pre-size</span></span><br><span class="line">               <span class="keyword">float</span> ft = ((<span class="keyword">float</span>)s / loadFactor) + <span class="number">1.0F</span>;</span><br><span class="line">               <span class="keyword">int</span> t = ((ft &lt; (<span class="keyword">float</span>)MAXIMUM_CAPACITY) ?</span><br><span class="line">                        (<span class="keyword">int</span>)ft : MAXIMUM_CAPACITY);</span><br><span class="line">               <span class="keyword">if</span> (t &gt; threshold)</span><br><span class="line">                   threshold = tableSizeFor(t);</span><br><span class="line">           &#125;</span><br><span class="line">           <span class="comment">//å¦‚æœå‚æ•°Mapçš„sizeå¤§äºthresholdï¼Œåˆ™è¿›è¡Œresize()æ‰©å®¹ã€‚</span></span><br><span class="line">           <span class="keyword">else</span> <span class="keyword">if</span> (s &gt; threshold)</span><br><span class="line">               resize();</span><br><span class="line">           <span class="comment">//éå†å‚æ•°Mapï¼Œå°†å€¼èµ‹ç»™å½“å‰HashMap</span></span><br><span class="line">           <span class="keyword">for</span> (Map.Entry&lt;? extends K, ? extends V&gt; e : m.entrySet()) &#123;</span><br><span class="line">               K key = e.getKey();</span><br><span class="line">               V value = e.getValue();</span><br><span class="line">               putVal(hash(key), key, value, <span class="keyword">false</span>, evict);</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<h3 id="çº¢é»‘æ ‘"><a href="#çº¢é»‘æ ‘" class="headerlink" title="çº¢é»‘æ ‘"></a>çº¢é»‘æ ‘</h3><p>JDK1.8å¼€å§‹ï¼ŒHashMapå¼•è¿›çº¢é»‘æ ‘ä½œä¸ºåˆä¸€å­˜å‚¨ç»“æ„ã€‚<br>ç”±äºç¯‡å¹…è¾ƒå¤šï¼Œè¯¦æƒ…è¯·ç§»æ­¥:<a href="2019/01/18/çº¢é»‘æ ‘è¯¦è§£/">çº¢é»‘æ ‘</a></p>
<h3 id="HashMap-å·¥ä½œåŸç†"><a href="#HashMap-å·¥ä½œåŸç†" class="headerlink" title="HashMap å·¥ä½œåŸç†"></a>HashMap å·¥ä½œåŸç†</h3><p>HashMap æ˜¯åŸºäºhashingçš„åŸç†ã€‚    </p>
<p>æˆ‘ä»¬ä½¿ç”¨put(key,value)å­˜å‚¨å¯¹è±¡åˆ°HashMapä¸­ï¼Œä½¿ç”¨get(key)ä»HashMapä¸­è·å–å¯¹è±¡ã€‚å½“æˆ‘ä»¬ç»™put()æ–¹æ³•ä¼ é€’key-valueé”®å€¼å¯¹æ—¶ï¼Œæˆ‘ä»¬å…ˆå¯¹é”®è¿›è¡ŒhashCode()æ–¹æ³•ï¼Œè®¡ç®—å¹¶è¿”å›çš„hashCodeï¼Œé€šè¿‡è¯¥å€¼æ‰¾åˆ°Mapæ•°ç»„çš„Bucketä½ç½®æ¥å­˜å‚¨Nodeå¯¹è±¡ã€‚</p>
<h4 id="HashMap-putæ–¹æ³•åˆ†æ"><a href="#HashMap-putæ–¹æ³•åˆ†æ" class="headerlink" title="HashMap putæ–¹æ³•åˆ†æ"></a>HashMap putæ–¹æ³•åˆ†æ</h4><p>åœ¨ç½‘ä¸Šæ‰¾åˆ°äº†è¿™å¼ å›¾ï¼Œæ„Ÿè°¢åŸä½œè€…ï¼Œå¼•ç”¨åœ°å€å·²åœ¨æ–‡æœ«æ ‡è¯†ã€‚<br>HashMapçš„putæ–¹æ³•æ‰§è¡Œè¿‡ç¨‹å¯ä»¥é€šè¿‡ä¸‹å›¾æ¥ç†è§£ã€‚<br><img src="https://ws2.sinaimg.cn/large/006tNc79ly1fzar66rfkej311v0u07cj.jpg" alt=""></p>
<p><strong>putæºç åˆ†æï¼š</strong></p>
<ol>
<li>åˆ¤æ–­Key-Valueçš„èŠ‚ç‚¹æ•°ç»„æ˜¯å¦ä¸ºnullï¼Œå¦‚æœæ˜¯å°±æ‰§è¡Œresize()æ‰©å®¹</li>
<li>é€šè¿‡å¯¹keyå°±è¡Œhashè¿ç®—ï¼Œæˆ‘ä»¬å¾—åˆ°äº†hashå€¼ï¼Œæ ¹æ®hashå€¼é€šè¿‡è®¡ç®—å¾—åˆ°æ’å…¥æ•°ç»„çš„ç´¢å¼•iï¼Œå¦‚æœtable[i]==nullï¼Œå°±åœ¨è¯¥ç´¢å¼•ä½ç½®å»ºç«‹æ–°çš„èŠ‚ç‚¹ï¼Œå¹¶è½¬å‘æ­¥éª¤9ï¼Œå¦åˆ™æ‰§è¡Œæ­¥éª¤3</li>
<li>åˆ¤æ–­table[i]çš„é¦–ä¸ªèŠ‚ç‚¹æ˜¯å¦å’Œkeyå€¼ä¸€æ ·ï¼Œå¦‚æœç›¸åŒç›´æ¥è¦†ç›–valueï¼Œå¦åˆ™è½¬å‘æ­¥éª¤4ï¼Œè¿™é‡Œçš„ç›¸åŒæŒ‡çš„æ˜¯hashCodeä»¥åŠequals</li>
<li>åˆ¤æ–­æ•°ç»„table[i]çš„å½“å‰èŠ‚ç‚¹æ˜¯å¦ä¸ºçº¢é»‘æ ‘ï¼Œå¦‚æœæ˜¯çº¢é»‘æ ‘ï¼Œåˆ™ç›´æ¥é€šè¿‡putTreeVal()æ–¹æ³•åœ¨æ ‘ä¸­æ’å…¥é”®å€¼å¯¹ï¼Œå¦åˆ™è½¬å‘æ­¥éª¤5</li>
<li>å¦‚æœä¸æ˜¯çº¢é»‘æ ‘ï¼Œåˆ™å½“å‰èŠ‚ç‚¹ä¸‹çš„æ•°æ®ç»“æ„ä¸ºé“¾è¡¨</li>
<li>ä»JDK1.8å¼€å§‹ï¼Œé“¾è¡¨çš„æ’å…¥æ˜¯å°¾æ’æ³•ï¼Œä¹‹å‰ä¸ºå¤´æ’æ³•ï¼Œ<a href="http://www.cnblogs.com/andy-zhou/p/5402984.html" target="_blank" rel="noopener">å¤´æ’æ³•çš„ç¼ºé™·</a>;</li>
<li>éå†table[i],åˆ¤æ–­é“¾è¡¨çš„é•¿åº¦æ˜¯å¦å¤§äº8ï¼Œå¤§äº8çš„è¯æŠŠé“¾è¡¨è½¬æ¢ä¸ºçº¢é»‘æ ‘ï¼Œåœ¨çº¢é»‘æ ‘ä¸­è¿›è¡Œæ’å…¥æ“ä½œã€‚</li>
<li>å¦‚æœä¸æ˜¯çº¢é»‘æ ‘ï¼Œåˆ™ä¸ºé“¾è¡¨çš„æ’å…¥æ–¹æ³•ï¼Œéå†è¿‡ç¨‹ä¸­è‹¥å‘ç°keyå·²ç»å­˜åœ¨ç›´æ¥è¦†ç›–valueå³å¯ã€‚</li>
<li>æ’å…¥æˆåŠŸåï¼Œåˆ¤æ–­å®é™…å­˜åœ¨çš„é”®å€¼å¯¹æ•°é‡sizeæ˜¯å¦è¶…å¤šäº†æœ€å¤§å®¹é‡thresholdï¼Œå¦‚æœè¶…è¿‡ï¼Œè¿›è¡Œæ‰©å®¹ã€‚</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> V <span class="title">put</span><span class="params">(K key, V value)</span> </span>&#123;</span><br><span class="line">       <span class="keyword">return</span> putVal(hash(key), key, value, <span class="keyword">false</span>, <span class="keyword">true</span>);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">final</span> V <span class="title">putVal</span><span class="params">(<span class="keyword">int</span> hash, K key, V value, <span class="keyword">boolean</span> onlyIfAbsent,</span></span></span><br><span class="line"><span class="function"><span class="params">                  <span class="keyword">boolean</span> evict)</span> </span>&#123;</span><br><span class="line">       Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; <span class="keyword">int</span> n, i;</span><br><span class="line">       <span class="comment">// 1.åˆ¤æ–­tabèŠ‚ç‚¹æ•°ç»„æ˜¯å¦ä¸ºç©º</span></span><br><span class="line">       <span class="keyword">if</span> ((tab = table) == <span class="keyword">null</span> || (n = tab.length) == <span class="number">0</span>)</span><br><span class="line">           n = (tab = resize()).length;</span><br><span class="line">       <span class="comment">// 2.è®¡ç®—indexï¼Œå¹¶å¯¹nullåšå¤„ç† </span></span><br><span class="line">       <span class="keyword">if</span> ((p = tab[i = (n - <span class="number">1</span>) &amp; hash]) == <span class="keyword">null</span>)</span><br><span class="line">           tab[i] = newNode(hash, key, value, <span class="keyword">null</span>);</span><br><span class="line">       <span class="keyword">else</span> &#123;</span><br><span class="line">           Node&lt;K,V&gt; e; K k;</span><br><span class="line">           <span class="comment">// 3.åˆ¤æ–­èŠ‚ç‚¹keyæ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨åˆ™è¦†ç›–value</span></span><br><span class="line">           <span class="keyword">if</span> (p.hash == hash &amp;&amp;</span><br><span class="line">               ((k = p.key) == key || (key != <span class="keyword">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">               e = p;</span><br><span class="line">           <span class="comment">// 4.åˆ¤æ–­è¯¥æ•°ç»„ä¸‹çš„é“¾è¡¨æ˜¯å¦ä¸ºçº¢é»‘æ ‘</span></span><br><span class="line">           <span class="keyword">else</span> <span class="keyword">if</span> (p <span class="keyword">instanceof</span> TreeNode)</span><br><span class="line">               e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(<span class="keyword">this</span>, tab, hash, key, value);</span><br><span class="line">           <span class="comment">// 5.åˆ¤æ–­ä¸ºé“¾è¡¨</span></span><br><span class="line">           <span class="keyword">else</span> &#123;</span><br><span class="line">               <span class="keyword">for</span> (<span class="keyword">int</span> binCount = <span class="number">0</span>; ; ++binCount) &#123;</span><br><span class="line">               	    <span class="comment">// 6.JDK1.8å¼€å§‹ é“¾è¡¨çš„æ’å…¥æ˜¯å°¾æ’æ³•</span></span><br><span class="line">                   <span class="keyword">if</span> ((e = p.next) == <span class="keyword">null</span>) &#123;</span><br><span class="line">                       p.next = newNode(hash, key, value, <span class="keyword">null</span>);</span><br><span class="line">                       <span class="comment">// 7.é“¾è¡¨é•¿åº¦å¦‚æœå¤§äº8åˆ™è½¬æ¢ä¸ºçº¢é»‘æ ‘</span></span><br><span class="line">                       <span class="keyword">if</span> (binCount &gt;= TREEIFY_THRESHOLD - <span class="number">1</span>) <span class="comment">// -1 for 1st</span></span><br><span class="line">                           treeifyBin(tab, hash);</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                   &#125;</span><br><span class="line">                   <span class="comment">// 8.keyå·²å­˜åœ¨åˆ™ç›´æ¥è¦†ç›–value</span></span><br><span class="line">                   <span class="keyword">if</span> (e.hash == hash &amp;&amp;</span><br><span class="line">                       ((k = e.key) == key || (key != <span class="keyword">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                   p = e;</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line">           <span class="keyword">if</span> (e != <span class="keyword">null</span>) &#123; <span class="comment">// existing mapping for key</span></span><br><span class="line">               V oldValue = e.value;</span><br><span class="line">               <span class="keyword">if</span> (!onlyIfAbsent || oldValue == <span class="keyword">null</span>)</span><br><span class="line">                   e.value = value;</span><br><span class="line">               afterNodeAccess(e);</span><br><span class="line">               <span class="keyword">return</span> oldValue;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">       ++modCount;</span><br><span class="line">       <span class="comment">// 9.å¦‚æœç°åœ¨çš„è¶…è¿‡å®¹é‡é˜ˆå€¼ å°±æ‰©å®¹</span></span><br><span class="line">       <span class="keyword">if</span> (++size &gt; threshold)</span><br><span class="line">           resize();</span><br><span class="line">       afterNodeInsertion(evict);</span><br><span class="line">       <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<h4 id="HashMap-getæ–¹æ³•åˆ†æ"><a href="#HashMap-getæ–¹æ³•åˆ†æ" class="headerlink" title="HashMap getæ–¹æ³•åˆ†æ"></a>HashMap getæ–¹æ³•åˆ†æ</h4><p>å½“æˆ‘ä»¬è°ƒç”¨ get() æ–¹æ³•ï¼ŒHashMap ä¼šä½¿ç”¨é”®å¯¹è±¡çš„ hashcode æ‰¾åˆ° bucket ä½ç½®ï¼Œæ‰¾åˆ° bucket ä½ç½®ä¹‹åï¼Œä¼šè°ƒç”¨ keys.equals() æ–¹æ³•å»æ‰¾åˆ°é“¾è¡¨ä¸­æ­£ç¡®çš„èŠ‚ç‚¹ï¼Œæœ€ç»ˆæ‰¾åˆ°è¦æ‰¾çš„å€¼å¯¹è±¡ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> V <span class="title">get</span><span class="params">(Object key)</span> </span>&#123;</span><br><span class="line">    Node&lt;K,V&gt; e;</span><br><span class="line">    <span class="comment">// æ ¹æ®è¾“å…¥èŠ‚ç‚¹çš„hashå€¼å’Œkeyå€¼åˆ©ç”¨getNode()æ–¹æ³•è¿›è¡ŒæŸ¥æ‰¾</span></span><br><span class="line">    <span class="keyword">return</span> (e = getNode(hash(key), key)) == <span class="keyword">null</span> ? <span class="keyword">null</span> : e.value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">final</span> Node&lt;K,V&gt; <span class="title">getNode</span><span class="params">(<span class="keyword">int</span> hash, Object key)</span> </span>&#123;</span><br><span class="line">    Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; first, e; <span class="keyword">int</span> n; K k;</span><br><span class="line">    <span class="comment">// 1.åˆ¤æ–­tabèŠ‚ç‚¹æ•°ç»„æ˜¯å¦ä¸ºç©ºï¼Œå¹¶ä¸”tabèŠ‚ç‚¹ä¸‹çš„é“¾è¡¨æˆ–çº¢é»‘æ ‘çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹éƒ¨ä¸ä¸º</span></span><br><span class="line">    <span class="keyword">if</span> ((tab = table) != <span class="keyword">null</span> &amp;&amp; (n = tab.length) &gt; <span class="number">0</span> &amp;&amp;</span><br><span class="line">        (first = tab[(n - <span class="number">1</span>) &amp; hash]) != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (first.hash == hash &amp;&amp; <span class="comment">// always check first node</span></span><br><span class="line">            ((k = first.key) == key || (key != <span class="keyword">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">            <span class="keyword">return</span> first;</span><br><span class="line">        <span class="comment">// 2. è¯¥èŠ‚ç‚¹ä¸‹å¦‚æœæŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">        <span class="keyword">if</span> ((e = first.next) != <span class="keyword">null</span>) &#123;</span><br><span class="line">        		<span class="comment">// 3.è‹¥å®šä½åˆ°çš„èŠ‚ç‚¹æ˜¯ã€€TreeNode èŠ‚ç‚¹ï¼Œåˆ™åœ¨æ ‘ä¸­è¿›è¡ŒæŸ¥æ‰¾</span></span><br><span class="line">            <span class="keyword">if</span> (first <span class="keyword">instanceof</span> TreeNode)</span><br><span class="line">                <span class="keyword">return</span> ((TreeNode&lt;K,V&gt;)first).getTreeNode(hash, key);</span><br><span class="line">            <span class="keyword">do</span> &#123;</span><br><span class="line">                <span class="comment">// 4.å¦åˆ™åœ¨é“¾è¡¨ä¸­è¿›è¡ŒæŸ¥æ‰¾ï¼Œä¼šè°ƒç”¨ keys.equals() æ–¹æ³•å»æ‰¾åˆ°é“¾è¡¨ä¸­æ­£ç¡®çš„èŠ‚ç‚¹ï¼Œæœ€ç»ˆæ‰¾åˆ°è¦æ‰¾çš„å€¼å¯¹è±¡</span></span><br><span class="line">                <span class="keyword">if</span> (e.hash == hash &amp;&amp;</span><br><span class="line">                    ((k = e.key) == key || (key != <span class="keyword">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">                    <span class="keyword">return</span> e;</span><br><span class="line">            &#125; <span class="keyword">while</span> ((e = e.next) != <span class="keyword">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ ‘ä¸­æŸ¥æ‰¾çš„æºç åˆ†æï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">final</span> TreeNode&lt;K,V&gt; <span class="title">getTreeNode</span><span class="params">(<span class="keyword">int</span> h, Object k)</span> </span>&#123;</span><br><span class="line">	 <span class="comment">//ä»æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œè°ƒç”¨ find æ–¹æ³•è¿›è¡ŒæŸ¥æ‰¾</span></span><br><span class="line">    <span class="keyword">return</span> ((parent != <span class="keyword">null</span>) ? root() : <span class="keyword">this</span>).find(h, k, <span class="keyword">null</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">final</span> TreeNode&lt;K,V&gt; <span class="title">find</span><span class="params">(<span class="keyword">int</span> h, Object k, Class&lt;?&gt; kc)</span> </span>&#123;</span><br><span class="line">    TreeNode&lt;K,V&gt; p = <span class="keyword">this</span>;</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        <span class="keyword">int</span> ph, dir; K pk;</span><br><span class="line">        TreeNode&lt;K,V&gt; pl = p.left, pr = p.right, q;</span><br><span class="line">        <span class="comment">// é¦–å…ˆè¿›è¡Œhashå€¼å¤§å°æ¯”è¾ƒï¼Œæ ¹æ®å¤§å°æŠŠå½“å‰èŠ‚ç‚¹å˜ä¸ºå®ƒçš„å·¦å­æ ‘æˆ–è€…å³å­æ ‘</span></span><br><span class="line">        <span class="keyword">if</span> ((ph = p.hash) &gt; h)</span><br><span class="line">            p = pl;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (ph &lt; h)</span><br><span class="line">            p = pr;</span><br><span class="line">        <span class="comment">// å¦‚æœhashå€¼ç›¸åŒï¼Œåˆ™å¼€å§‹æ¯”è¾ƒkeyå€¼ï¼Œå¦‚æœkeyå€¼ç›¸ç­‰å°±ç›´æ¥è¿”å›è¯¥èŠ‚ç‚¹ã€‚</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ((pk = p.key) == k || (k != <span class="keyword">null</span> &amp;&amp; k.equals(pk)))</span><br><span class="line">            <span class="keyword">return</span> p;</span><br><span class="line">        <span class="comment">// å¦‚æœ å·¦å­æ ‘æˆ–è€…å³å­æ ‘ä¸ºç©º åˆ™æŒ‡å‘å¦ä¸€ä¾§çš„å­æ ‘</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (pl == <span class="keyword">null</span>)</span><br><span class="line">            p = pr;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (pr == <span class="keyword">null</span>)</span><br><span class="line">            p = pl;</span><br><span class="line">        <span class="comment">//æ‰§è¡Œåˆ°è¿™å„¿ï¼Œæ„å‘³ç€hash å€¼ç›¸åŒï¼Œkey å€¼ä¸åŒ</span></span><br><span class="line">        <span class="comment">//è‹¥k æ˜¯å¯æ¯”è¾ƒçš„å¹¶ä¸”k.compareTo(pk) è¿”å›ç»“æœä¸ä¸ºï¼å¯è¿›å…¥ä¸‹é¢elseif   </span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ((kc != <span class="keyword">null</span> ||</span><br><span class="line">                  (kc = comparableClassFor(k)) != <span class="keyword">null</span>) &amp;&amp;</span><br><span class="line">                 (dir = compareComparables(kc, k, pk)) != <span class="number">0</span>)</span><br><span class="line">            p = (dir &lt; <span class="number">0</span>) ? pl : pr;</span><br><span class="line">        <span class="comment">//è‹¥ k æ˜¯ä¸å¯æ¯”è¾ƒçš„ã€€æˆ–è€…ã€€k.compareTo(pk) è¿”å›ç»“æœä¸ºï¼åˆ™åœ¨æ•´æ£µæ ‘ä¸­è¿›è¡ŒæŸ¥æ‰¾ï¼Œå…ˆæ‰¾å³å­æ ‘ï¼Œå³å­æ ‘æ²¡æœ‰å†æ‰¾å·¦å­æ ‘</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ((q = pr.find(h, k, kc)) != <span class="keyword">null</span>)</span><br><span class="line">            <span class="keyword">return</span> q;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            p = pl;</span><br><span class="line">    &#125; <span class="keyword">while</span> (p != <span class="keyword">null</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="å‡å°‘hashç¢°æ’"><a href="#å‡å°‘hashç¢°æ’" class="headerlink" title="å‡å°‘hashç¢°æ’"></a>å‡å°‘hashç¢°æ’</h4><p>æ‰°åŠ¨å‡½æ•°å¯ä»¥å‡å°‘ç¢°æ’</p>
<p>åŸç†æ˜¯å¦‚æœä¸¤ä¸ªä¸ç›¸ç­‰çš„å¯¹è±¡è¿”å›ä¸åŒçš„ hashcode çš„è¯ï¼Œé‚£ä¹ˆç¢°æ’çš„å‡ ç‡å°±ä¼šå°äº›ã€‚è¿™å°±æ„å‘³ç€å­˜é“¾è¡¨ç»“æ„å‡å°ï¼Œè¿™æ ·å–å€¼çš„è¯å°±ä¸ä¼šé¢‘ç¹è°ƒç”¨ equal æ–¹æ³•ï¼Œä»è€Œæé«˜ HashMap çš„æ€§èƒ½ï¼ˆæ‰°åŠ¨å³ Hash æ–¹æ³•å†…éƒ¨çš„ç®—æ³•å®ç°ï¼Œç›®çš„æ˜¯è®©ä¸åŒå¯¹è±¡è¿”å›ä¸åŒ hashcodeï¼‰ã€‚</p>
<p>ä½¿ç”¨ä¸å¯å˜çš„ã€å£°æ˜ä½œ final å¯¹è±¡ï¼Œå¹¶ä¸”é‡‡ç”¨åˆé€‚çš„ equals() å’Œ hashCode() æ–¹æ³•ï¼Œå°†ä¼šå‡å°‘ç¢°æ’çš„å‘ç”Ÿ</p>
<p>ä¸å¯å˜æ€§ä½¿å¾—èƒ½å¤Ÿç¼“å­˜ä¸åŒé”®çš„ hashcodeï¼Œè¿™å°†æé«˜æ•´ä¸ªè·å–å¯¹è±¡çš„é€Ÿåº¦ï¼Œä½¿ç”¨ Stringã€Integer è¿™æ ·çš„ wrapper ç±»ä½œä¸ºé”®æ˜¯éå¸¸å¥½çš„é€‰æ‹©ã€‚</p>
<p>å› ä¸º String æ˜¯ finalï¼Œè€Œä¸”å·²ç»é‡å†™äº† equals() å’Œ hashCode() æ–¹æ³•äº†ã€‚ä¸å¯å˜æ€§æ˜¯å¿…è¦çš„ï¼Œå› ä¸ºä¸ºäº†è¦è®¡ç®— hashCode()ï¼Œå°±è¦é˜²æ­¢é”®å€¼æ”¹å˜ï¼Œå¦‚æœé”®å€¼åœ¨æ”¾å…¥æ—¶å’Œè·å–æ—¶è¿”å›ä¸åŒçš„ hashcode çš„è¯ï¼Œé‚£ä¹ˆå°±ä¸èƒ½ä» HashMap ä¸­æ‰¾åˆ°ä½ æƒ³è¦çš„å¯¹è±¡ã€‚</p>
<h4 id="HashMapæ‰©å®¹æ–¹æ³•-resize"><a href="#HashMapæ‰©å®¹æ–¹æ³•-resize" class="headerlink" title="HashMapæ‰©å®¹æ–¹æ³• resize()"></a>HashMapæ‰©å®¹æ–¹æ³• resize()</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> Node&lt;K,V&gt;[] resize() &#123;</span><br><span class="line">       Node&lt;K,V&gt;[] oldTab = table;</span><br><span class="line">       <span class="comment">// æ—§æ•°ç»„çš„å¤§å°</span></span><br><span class="line">       <span class="keyword">int</span> oldCap = (oldTab == <span class="keyword">null</span>) ? <span class="number">0</span> : oldTab.length;</span><br><span class="line">       <span class="comment">// æ—§æ•°ç»„çš„æ‰©å®¹é˜ˆå€¼</span></span><br><span class="line">       <span class="keyword">int</span> oldThr = threshold;</span><br><span class="line">       <span class="keyword">int</span> newCap, newThr = <span class="number">0</span>;</span><br><span class="line">       <span class="keyword">if</span> (oldCap &gt; <span class="number">0</span>) &#123;</span><br><span class="line">           <span class="comment">// å¦‚æœæ—§æ•°ç»„çš„å¤§å°å¤§äº0ï¼Œå¹¶ä¸”å…¶å¤§å°å·²ç»ç­‰äºæœ€å¤§çš„æ•°ç»„å®¹é‡</span></span><br><span class="line">           <span class="keyword">if</span> (oldCap &gt;= MAXIMUM_CAPACITY) &#123;</span><br><span class="line">           	   <span class="comment">// åˆ™æ‰©å®¹é˜ˆå€¼è®¾ä¸ºIntegerçš„æœ€å¤§å€¼,å¹¶ç›´æ¥è¿”å›æ—§æ•°ç»„ä¸å†æ‰©å®¹</span></span><br><span class="line">               threshold = Integer.MAX_VALUE;</span><br><span class="line">               <span class="keyword">return</span> oldTab;</span><br><span class="line">           &#125;</span><br><span class="line">           <span class="comment">// å¦‚æœæ—§æ•°ç»„äºŒå€çš„å®¹é‡å°äºæœ€å¤§å®¹é‡ å¹¶ä¸”æ—§è¡¨æ•°ç»„å®¹é‡å¤§äºé»˜è®¤å€¼16 </span></span><br><span class="line">           <span class="keyword">else</span> <span class="keyword">if</span> ((newCap = oldCap &lt;&lt; <span class="number">1</span>) &lt; MAXIMUM_CAPACITY &amp;&amp;</span><br><span class="line">                    oldCap &gt;= DEFAULT_INITIAL_CAPACITY)</span><br><span class="line">               <span class="comment">// åˆ™æ–°æ•°ç»„çš„æ‰©å®¹é˜ˆå€¼ä¸ºæ—§æ•°ç»„çš„äºŒå€</span></span><br><span class="line">               newThr = oldThr &lt;&lt; <span class="number">1</span>; <span class="comment">// double threshold</span></span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">else</span> <span class="keyword">if</span> (oldThr &gt; <span class="number">0</span>) <span class="comment">// initial capacity was placed in threshold</span></span><br><span class="line">           newCap = oldThr;</span><br><span class="line">       <span class="keyword">else</span> &#123;               <span class="comment">// zero initial threshold signifies using defaults</span></span><br><span class="line">           <span class="comment">//é˜€å€¼å’Œå®¹é‡ä½¿ç”¨é»˜è®¤å€¼</span></span><br><span class="line">           newCap = DEFAULT_INITIAL_CAPACITY;</span><br><span class="line">           newThr = (<span class="keyword">int</span>)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY);</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">if</span> (newThr == <span class="number">0</span>) &#123;</span><br><span class="line">           <span class="comment">// è®¡ç®—æ–°çš„é˜ˆå€¼</span></span><br><span class="line">           <span class="keyword">float</span> ft = (<span class="keyword">float</span>)newCap * loadFactor;</span><br><span class="line">           <span class="comment">// é˜€å€¼æ²¡æœ‰è¶…è¿‡æœ€å¤§é˜€å€¼ï¼Œè®¾ç½®æ–°çš„é˜€å€¼</span></span><br><span class="line">           newThr = (newCap &lt; MAXIMUM_CAPACITY &amp;&amp; ft &lt; (<span class="keyword">float</span>)MAXIMUM_CAPACITY ?</span><br><span class="line">                     (<span class="keyword">int</span>)ft : Integer.MAX_VALUE);</span><br><span class="line">       &#125;</span><br><span class="line">       threshold = newThr;</span><br><span class="line">       <span class="meta">@SuppressWarnings</span>(&#123;<span class="string">"rawtypes"</span>,<span class="string">"unchecked"</span>&#125;)</span><br><span class="line">           <span class="comment">// åˆ›å»ºæ–°çš„Hashè¡¨</span></span><br><span class="line">           Node&lt;K,V&gt;[] newTab = (Node&lt;K,V&gt;[])<span class="keyword">new</span> Node[newCap];</span><br><span class="line">       table = newTab;</span><br><span class="line">       <span class="comment">// éå†æ—§çš„Hashè¡¨</span></span><br><span class="line">       <span class="keyword">if</span> (oldTab != <span class="keyword">null</span>) &#123;</span><br><span class="line">           <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; oldCap; ++j) &#123;</span><br><span class="line">               Node&lt;K,V&gt; e;</span><br><span class="line">               <span class="keyword">if</span> ((e = oldTab[j]) != <span class="keyword">null</span>) &#123;</span><br><span class="line">                   <span class="comment">// é‡Šæ”¾ç©ºé—´</span></span><br><span class="line">                   oldTab[j] = <span class="keyword">null</span>;</span><br><span class="line">                   <span class="comment">//å½“å‰èŠ‚ç‚¹ä¸æ˜¯ä»¥é“¾è¡¨çš„å½¢å¼å­˜åœ¨</span></span><br><span class="line">                   <span class="keyword">if</span> (e.next == <span class="keyword">null</span>)</span><br><span class="line">                       newTab[e.hash &amp; (newCap - <span class="number">1</span>)] = e;</span><br><span class="line">                   <span class="keyword">else</span> <span class="keyword">if</span> (e <span class="keyword">instanceof</span> TreeNode)</span><br><span class="line">                       <span class="comment">// åˆ™ä¸ºçº¢é»‘æ ‘</span></span><br><span class="line">                       ((TreeNode&lt;K,V&gt;)e).split(<span class="keyword">this</span>, newTab, j, oldCap);</span><br><span class="line">                   <span class="keyword">else</span> &#123; <span class="comment">// preserve order</span></span><br><span class="line">                       <span class="comment">//ä»¥é“¾è¡¨å½¢å¼å­˜åœ¨çš„èŠ‚ç‚¹ï¼›</span></span><br><span class="line">                       Node&lt;K,V&gt; loHead = <span class="keyword">null</span>, loTail = <span class="keyword">null</span>;</span><br><span class="line">                       Node&lt;K,V&gt; hiHead = <span class="keyword">null</span>, hiTail = <span class="keyword">null</span>;</span><br><span class="line">                       Node&lt;K,V&gt; next;</span><br><span class="line">                       <span class="keyword">do</span> &#123;</span><br><span class="line">                           next = e.next;</span><br><span class="line">                           <span class="keyword">if</span> ((e.hash &amp; oldCap) == <span class="number">0</span>) &#123;</span><br><span class="line">                               <span class="keyword">if</span> (loTail == <span class="keyword">null</span>)</span><br><span class="line">                                   loHead = e;</span><br><span class="line">                               <span class="keyword">else</span></span><br><span class="line">                                   loTail.next = e;</span><br><span class="line">                               loTail = e;</span><br><span class="line">                           &#125;</span><br><span class="line">                           <span class="keyword">else</span> &#123;</span><br><span class="line">                               <span class="keyword">if</span> (hiTail == <span class="keyword">null</span>)</span><br><span class="line">                                   hiHead = e;</span><br><span class="line">                               <span class="keyword">else</span></span><br><span class="line">                                   hiTail.next = e;</span><br><span class="line">                               hiTail = e;</span><br><span class="line">                           &#125;</span><br><span class="line">                       &#125; <span class="keyword">while</span> ((e = next) != <span class="keyword">null</span>);</span><br><span class="line">                       <span class="keyword">if</span> (loTail != <span class="keyword">null</span>) &#123;</span><br><span class="line">                           loTail.next = <span class="keyword">null</span>;</span><br><span class="line">                           newTab[j] = loHead;</span><br><span class="line">                       &#125;</span><br><span class="line">                       <span class="keyword">if</span> (hiTail != <span class="keyword">null</span>) &#123;</span><br><span class="line">                           hiTail.next = <span class="keyword">null</span>;</span><br><span class="line">                           newTab[j + oldCap] = hiHead;</span><br><span class="line">                       &#125;</span><br><span class="line">                   &#125;</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> newTab;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<p>resize()æ–¹æ³•ä¸­æ¯”è¾ƒé‡è¦çš„æ˜¯é“¾è¡¨å’Œçº¢é»‘æ ‘çš„rehash()æ“ä½œï¼Œå…ˆæ¥è¯´ä¸‹rehash()çš„å®ç°åŸç†ï¼š</p>
<p>åœ¨æ‰©å®¹çš„æ—¶å€™ï¼Œä¸€èˆ¬æ˜¯æŠŠé•¿åº¦æ‰©ä¸ºåŸæ¥2å€ï¼Œæ‰€ä»¥ï¼Œå…ƒç´ çš„ä½ç½®è¦ä¹ˆæ˜¯åœ¨åŸä½ç½®ï¼Œè¦ä¹ˆæ˜¯åœ¨åŸä½ç½®å†ç§»åŠ¨2æ¬¡å¹‚çš„ä½ç½®ã€‚è¿™æ®µä»£ç å°±æ˜¯å…³äºä½ç½®è½¬æ¢çš„ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">    next = e.next;</span><br><span class="line">    <span class="keyword">if</span> ((e.hash &amp; oldCap) == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (loTail == <span class="keyword">null</span>)</span><br><span class="line">            loHead = e;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            loTail.next = e;</span><br><span class="line">        loTail = e;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (hiTail == <span class="keyword">null</span>)</span><br><span class="line">            hiHead = e;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            hiTail.next = e;</span><br><span class="line">        hiTail = e;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">while</span> ((e = next) != <span class="keyword">null</span>);</span><br><span class="line"><span class="keyword">if</span> (loTail != <span class="keyword">null</span>) &#123;</span><br><span class="line">    loTail.next = <span class="keyword">null</span>;</span><br><span class="line">    newTab[j] = loHead;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (hiTail != <span class="keyword">null</span>) &#123;</span><br><span class="line">    hiTail.next = <span class="keyword">null</span>;</span><br><span class="line">    newTab[j + oldCap] = hiHead;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å‡å¦‚æˆ‘ä»¬æœ‰å››ä¸ªæ•°ä¸º5ï¼Œ21ï¼Œ37ï¼Œ53ã€‚å¹¶ä¸”oldTabçš„åˆå§‹å®¹é‡ä¸º16ã€‚å³4ä¸ªæ•°çš„äºŒè¿›åˆ¶å¦‚ä¸‹ï¼š</p>
<ul>
<li>5 ï¼š00000101</li>
<li>21ï¼š00010101</li>
<li>37ï¼š00100101</li>
<li>53ï¼š00110101    </li>
</ul>
<p>åœ¨oldTabä¸­ï¼Œå››ä¸ªæ•°ä¼šä¸ï¼ˆ16-1ï¼‰åšä¸è¿ç®—ï¼Œä¹Ÿå°±æ˜¯ä¸1111åšä¸è¿ç®—ï¼Œè¿ç®—ä¹‹åç»“æœå¦‚ä¸‹ï¼š</p>
<ul>
<li>5 ï¼š00000101</li>
<li>21ï¼š00010101</li>
<li>37ï¼š00100101</li>
<li>53ï¼š00110101</li>
</ul>
<p>å››ä¸ªæ•°ä¸ï¼ˆ16-1ï¼‰ç›¸ä¸åéƒ½æ˜¯0101ï¼Œå³åŸå§‹é“¾ä¸ºï¼š5â€”&gt;21â€”&gt;37â€”&gt;53â€”-&gt;nullã€‚<br>ç„¶åè¿›å…¥do-whileå¾ªç¯ï¼Œå¯¹é“¾è¡¨èŠ‚ç‚¹è¿›è¡Œéå†ï¼Œé€šè¿‡è¿ç®—æ¥åˆ¤æ–­æ˜¯åœ¨åŸæ¥ä½ç½®è¿˜æ˜¯å»æ‰©å®¹åçš„æ–°é“¾è¡¨ï¼š<br><strong>loå°±æ˜¯æ‰©å®¹åä»ç„¶åœ¨åŸåœ°çš„å…ƒç´ é“¾è¡¨</strong><br><strong>hiå°±æ˜¯æ‰©å®¹åä¸‹æ ‡ä¸ºã€ åŸä½ç½®+åŸå®¹é‡ ã€‘çš„å…ƒç´ é“¾è¡¨ï¼Œä»è€Œä¸éœ€è¦é‡æ–°è®¡ç®—hashã€‚</strong><br>å› ä¸ºæ‰©å®¹åè®¡ç®—å­˜å‚¨ä½ç½®å°±æ˜¯hash&amp;ï¼ˆ32 - 1ï¼‰ã€å–å5ä½ã€‘ï¼Œä½†æ˜¯å¹¶ä¸éœ€è¦å†è®¡ç®—ä¸€æ¬¡ä½ç½®ï¼Œ</p>
<p>æ­¤å¤„åªéœ€è¦åˆ¤æ–­å·¦è¾¹æ–°å¢çš„é‚£ä¸€ä½ï¼ˆå³æ•°ç¬¬5ä½ï¼‰æ˜¯å¦ä¸º1å³å¯åˆ¤æ–­æ­¤èŠ‚ç‚¹æ˜¯ç•™åœ¨åŸåœ°loè¿˜æ˜¯ç§»åŠ¨å»é«˜ä½hiï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(e.hash &amp; oldCap) == <span class="number">0</span></span><br></pre></td></tr></table></figure>
<p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä¸16è¿›è¡Œä¹Ÿå°±æ˜¯10000ï¼Œåšä¸è¿ç®—ã€‚</p>
<ul>
<li>5 ï¼š00000101â€”â€”â€”â€”â€”â€”ã€‹0ç•™åœ¨åŸåœ°  loé“¾è¡¨</li>
<li>21ï¼š00010101â€”â€”â€”â€”â€”â€”ã€‹1ç§»å‘é«˜ä½  hié“¾è¡¨</li>
<li>37ï¼š00100101â€”â€”â€”â€”â€”â€”ã€‹0ç•™åœ¨åŸåœ°  loé“¾è¡¨</li>
<li>53ï¼š00110101â€”â€”â€”â€”â€”â€”ã€‹1ç§»å‘é«˜ä½  hié“¾è¡¨    </li>
</ul>
<p>é€€å‡ºå¾ªç¯ååªéœ€è¦åˆ¤æ–­loï¼Œhiæ˜¯å¦ä¸ºç©ºï¼Œç„¶åæŠŠå„è‡ªé“¾è¡¨å¤´ç»“ç‚¹ç›´æ¥æ”¾åˆ°å¯¹åº”ä½ç½®ä¸Šå³å¯å®Œæˆæ•´ä¸ªé“¾è¡¨çš„ç§»åŠ¨ã€‚</p>
<p>åŸç†æ˜¯ï¼šåˆ©ç”¨äº†å°¾æŒ‡é’ˆTailï¼Œå®Œæˆäº†å°¾éƒ¨æ’å…¥ï¼Œä¸ä¼šé€ æˆé€†åºï¼Œæ‰€ä»¥ä¹Ÿä¸ä¼šäº§ç”Ÿå¹¶å‘æ­»é”çš„é—®é¢˜ã€‚</p>
<p>è¿™ç§æ–¹æ³•å¯¹æ¯”1.7ä¸­ç®—æ³•çš„ä¼˜ç‚¹æ˜¯ï¼š</p>
<p>1ã€ä¸ç®¡æ€ä¹ˆæ ·éƒ½ä¸éœ€è¦é‡æ–°å†è®¡ç®—hashï¼›</p>
<p>2ã€æ”¾è¿‡å»çš„é“¾è¡¨å†…å…ƒç´ çš„ç›¸å¯¹é¡ºåºä¸ä¼šæ”¹å˜ï¼›</p>
<p>3ã€ä¸ä¼šåœ¨å¹¶å‘æ‰©å®¹ä¸­å‘ç”Ÿæ­»é”ã€‚</p>
<h4 id="HashMap-hashå‡½æ•°å®ç°"><a href="#HashMap-hashå‡½æ•°å®ç°" class="headerlink" title="HashMap hashå‡½æ•°å®ç°"></a>HashMap hashå‡½æ•°å®ç°</h4><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œåœ¨ HashMap ä¸­è¦æ‰¾åˆ°æŸä¸ªå…ƒç´ ï¼Œéœ€è¦æ ¹æ® key çš„ hash å€¼æ¥æ±‚å¾—å¯¹åº”æ•°ç»„ä¸­çš„ä½ç½®ã€‚å¦‚ä½•è®¡ç®—è¿™ä¸ªä½ç½®å°±æ˜¯ hash ç®—æ³•ã€‚</p>
<p>å‰é¢è¯´è¿‡ï¼ŒHashMap çš„æ•°æ®ç»“æ„æ˜¯æ•°ç»„å’Œé“¾è¡¨çš„ç»“åˆï¼Œæ‰€ä»¥æˆ‘ä»¬å½“ç„¶å¸Œæœ›è¿™ä¸ª HashMap é‡Œé¢çš„å…ƒç´ ä½ç½®å°½é‡çš„åˆ†å¸ƒå‡åŒ€äº›ï¼Œå°½é‡ä½¿å¾—æ¯ä¸ªä½ç½®ä¸Šçš„å…ƒç´ æ•°é‡åªæœ‰ä¸€ä¸ªã€‚é‚£ä¹ˆå½“æˆ‘ä»¬ç”¨ hash ç®—æ³•æ±‚å¾—è¿™ä¸ªä½ç½®çš„æ—¶å€™ï¼Œé©¬ä¸Šå°±å¯ä»¥çŸ¥é“å¯¹åº”ä½ç½®çš„å…ƒç´ å°±æ˜¯æˆ‘ä»¬è¦çš„ï¼Œè€Œä¸ç”¨å†å»éå†é“¾è¡¨ã€‚ æ‰€ä»¥ï¼Œæˆ‘ä»¬é¦–å…ˆæƒ³åˆ°çš„å°±æ˜¯æŠŠ hashcode å¯¹æ•°ç»„é•¿åº¦å–æ¨¡è¿ç®—ã€‚è¿™æ ·ä¸€æ¥ï¼Œå…ƒç´ çš„åˆ†å¸ƒç›¸å¯¹æ¥è¯´æ˜¯æ¯”è¾ƒå‡åŒ€çš„ã€‚</p>
<p>ä½†æ˜¯â€œæ¨¡â€è¿ç®—çš„æ¶ˆè€—è¿˜æ˜¯æ¯”è¾ƒå¤§çš„ï¼Œèƒ½ä¸èƒ½æ‰¾ä¸€ç§æ›´å¿«é€Ÿã€æ¶ˆè€—æ›´å°çš„æ–¹å¼ï¼Ÿæˆ‘ä»¬æ¥çœ‹çœ‹ JDK1.8 æºç æ˜¯æ€ä¹ˆåšçš„</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> <span class="title">hash</span><span class="params">(Object key)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (key == <span class="keyword">null</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> h;</span><br><span class="line">    h = key.hashCode()ï¼›è¿”å›æ•£åˆ—å€¼ä¹Ÿå°±æ˜¯hashcode</span><br><span class="line">    <span class="comment">// ^ ï¼šæŒ‰ä½å¼‚æˆ–</span></span><br><span class="line">    <span class="comment">// &gt;&gt;&gt;:æ— ç¬¦å·å³ç§»ï¼Œå¿½ç•¥ç¬¦å·ä½ï¼Œç©ºä½éƒ½ä»¥0è¡¥é½</span></span><br><span class="line">    <span class="comment">//å…¶ä¸­næ˜¯æ•°ç»„çš„é•¿åº¦ï¼Œå³Mapçš„æ•°ç»„éƒ¨åˆ†åˆå§‹åŒ–é•¿åº¦</span></span><br><span class="line">    <span class="keyword">return</span> (n-<span class="number">1</span>)&amp;(h ^ (h &gt;&gt;&gt; <span class="number">16</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://ws1.sinaimg.cn/large/006tNc79ly1fzfbg2rw5sj311m0iqgul.jpg" alt=""></p>
<p>ç®€å•æ¥è¯´å°±æ˜¯ï¼š</p>
<p>é«˜16 bit ä¸å˜ï¼Œä½16 bit å’Œé«˜16 bit åšäº†ä¸€ä¸ªå¼‚æˆ–ï¼ˆå¾—åˆ°çš„ hashcode è½¬åŒ–ä¸º32ä½äºŒè¿›åˆ¶ï¼Œå‰16ä½å’Œå16ä½ä½16 bit å’Œé«˜16 bit åšäº†ä¸€ä¸ªå¼‚æˆ–ï¼‰</p>
<p>(nÂ·1) &amp; hash = -&gt; å¾—åˆ°ä¸‹æ ‡</p>
<p>å‚è€ƒï¼š<a href="https://www.cnblogs.com/JohnsonZilch/p/6554547.html" target="_blank" rel="noopener">https://www.cnblogs.com/JohnsonZilch/p/6554547.html</a><br>      <a href="https://www.cnblogs.com/Xieyang-blog/p/8886921.html" target="_blank" rel="noopener">https://www.cnblogs.com/Xieyang-blog/p/8886921.html</a></p>

    
  </div>

</article>


   
  <div class="text-center donation">
    <div class="inner-donation">
      <span class="btn-donation">æ”¯æŒä¸€ä¸‹</span>
      <div class="donation-body">
        <div class="tip text-center">æ‰«ä¸€æ‰«ï¼Œæ”¯æŒforsigner</div>
        <ul>
        
          <li class="item">
            
              <span>å¾®ä¿¡æ‰«ä¸€æ‰«</span>
            
            <img src="/images/qr-wechat.png" alt="">
          </li>
        
          <li class="item">
            
              <span>æ”¯ä»˜å®æ‰«ä¸€æ‰«</span>
            
            <img src="/images/qr-alipay.png" alt="">
          </li>
        
        </ul>
      </div>
    </div>
  </div>


   
  <div class="box-prev-next clearfix">
    <a class="show pull-left" href="/2019/01/18/çº¢é»‘æ ‘è¯¦è§£/">
        <i class="icon icon-angle-left"></i>
    </a>
    <a class="show pull-right" href="/2019/02/22/Zookeeperå¿«é€Ÿå…¥é—¨-é›†ç¾¤éƒ¨ç½²/">
        <i class="icon icon-angle-right"></i>
    </a>
  </div>




</div>


  <a id="backTop" class="back-top">
    <i class="icon-angle-up"></i>
  </a>




  <div class="modal" id="modal">
  <span id="cover" class="cover hide"></span>
  <div id="modal-dialog" class="modal-dialog hide-dialog">
    <div class="modal-header">
      <span id="close" class="btn-close">å…³é—­</span>
    </div>
    <hr>
    <div class="modal-body">
      <ul class="list-toolbox">
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/archives/"
              rel="noopener noreferrer"
              target="_self"
              >
              åšå®¢
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/categories/"
              rel="noopener noreferrer"
              target="_self"
              >
              åˆ†ç±»
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/tag/"
              rel="noopener noreferrer"
              target="_self"
              >
              æ ‡ç­¾
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/link/"
              rel="noopener noreferrer"
              target="_self"
              >
              å‹é“¾
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/about/"
              rel="noopener noreferrer"
              target="_self"
              >
              å…³äº
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/atom.xml"
              rel="noopener noreferrer"
              target="_blank"
              >
              RSS
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/search/"
              rel="noopener noreferrer"
              target="_self"
              >
              æœç´¢
            </a>
          </li>
        
      </ul>

    </div>
  </div>
</div>



  
      <div class="fexo-comments comments-post">
    

    

    
    

    

    
    

    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src="//cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js"></script>
    <div id="comment" class="vcomment" ></div>
    <script>
        var notify = 'false' == true ? true : false;
        var verify = 'false' == true ? true : false;
        var GUEST_INFO = ['nick','mail','link'];
        var guest_info = 'nick,mail,link'.split(',').filter(function(item){
            return GUEST_INFO.indexOf(item) > -1
        });
        guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;
        window.valine = new Valine({
            el: '.vcomment',
            notify: notify,
            verify: verify,
            appId: "9cprXYUH7H1YKlRERiGS8bxV-gzGzoHsz",
            appKey: "et0Drv2jnj4ILMBUSaNM2M2R",
            avatar:'mm',
            placeholder: "Talk to me ^_^",
            guest_info:guest_info,
            pageSize:'10'
        });
    </script>
  
    

  </div>

  

  <script type="text/javascript">
  function loadScript(url, callback) {
    var script = document.createElement('script')
    script.type = 'text/javascript';

    if (script.readyState) { //IE
      script.onreadystatechange = function() {
        if (script.readyState == 'loaded' ||
          script.readyState == 'complete') {
          script.onreadystatechange = null;
          callback();
        }
      };
    } else { //Others
      script.onload = function() {
        callback();
      };
    }

    script.src = url;
    document.getElementsByTagName('head')[0].appendChild(script);
  }

  window.onload = function() {
    loadScript('/js/bundle.js?235683', function() {
      // load success
    });
  }
</script>

</body>
</html>
