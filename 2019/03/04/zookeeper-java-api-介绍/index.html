<!DOCTYPE html>


  <html class="dark page-post">


<head>
  <meta charset="utf-8">
  <meta name="referrer" content="no-referrer" />
  
  <title>zookeeper java-api ä»‹ç» | MurasakiSeiFu</title>

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
    <meta name="keywords" content="java,redis,nginx,zookeeper,åˆ†å¸ƒå¼ä¸­é—´ä»¶,å¾®æœåŠ¡,springboot,mysql" />
  

  <meta name="description" content="zookeeper java-api ä»‹ç»åŸç”Ÿå¼•åŒ…é¦–å…ˆæˆ‘ä»¬å¼•å…¥gradleã€‚ 1compile &apos;org.apache.zookeeper:zookeeper:3.4.10&apos; åˆ›å»ºæˆ‘ä»¬çš„è¿æ¥ æˆ‘ä»¬å…ˆåˆ›å»ºä¸€ä¸ªç±»ï¼Œç±»åï¼šZookeeperCrudï¼Œç„¶ååˆ›å»ºä¸€ä¸ªæ„é€ å‡½æ•°ã€‚  123456789101112/** * @author: murasakiseifu * @date: 2019-02-27">
<meta property="og:type" content="article">
<meta property="og:title" content="zookeeper java-api ä»‹ç»">
<meta property="og:url" content="http://ilovenorth.life/2019/03/04/zookeeper-java-api-ä»‹ç»/index.html">
<meta property="og:site_name" content="MurasakiSeiFu">
<meta property="og:description" content="zookeeper java-api ä»‹ç»åŸç”Ÿå¼•åŒ…é¦–å…ˆæˆ‘ä»¬å¼•å…¥gradleã€‚ 1compile &apos;org.apache.zookeeper:zookeeper:3.4.10&apos; åˆ›å»ºæˆ‘ä»¬çš„è¿æ¥ æˆ‘ä»¬å…ˆåˆ›å»ºä¸€ä¸ªç±»ï¼Œç±»åï¼šZookeeperCrudï¼Œç„¶ååˆ›å»ºä¸€ä¸ªæ„é€ å‡½æ•°ã€‚  123456789101112/** * @author: murasakiseifu * @date: 2019-02-27">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2019-04-29T01:57:10.746Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="zookeeper java-api ä»‹ç»">
<meta name="twitter:description" content="zookeeper java-api ä»‹ç»åŸç”Ÿå¼•åŒ…é¦–å…ˆæˆ‘ä»¬å¼•å…¥gradleã€‚ 1compile &apos;org.apache.zookeeper:zookeeper:3.4.10&apos; åˆ›å»ºæˆ‘ä»¬çš„è¿æ¥ æˆ‘ä»¬å…ˆåˆ›å»ºä¸€ä¸ªç±»ï¼Œç±»åï¼šZookeeperCrudï¼Œç„¶ååˆ›å»ºä¸€ä¸ªæ„é€ å‡½æ•°ã€‚  123456789101112/** * @author: murasakiseifu * @date: 2019-02-27">

  

  
    <link rel="icon" href="/images/favicon.ico">
  

  <link href="/css/styles.css?v=c114cbeddx" rel="stylesheet">


  
    <link rel="stylesheet" href="/css/personal-style.css">
  

  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-86660611-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


  
  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?2e6da3c375c8a87f5b664cea6d4cb29c";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>


  
  <script type="text/javascript">
	(function(){
	    var bp = document.createElement('script');
	    var curProtocol = window.location.protocol.split(':')[0];
	    if (curProtocol === 'https') {
	        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
	    }
	    else {
	        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
	    }
	    var s = document.getElementsByTagName("script")[0];
	    s.parentNode.insertBefore(bp, s);
	})();
  </script>



  
    <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.3.0/css/font-awesome.min.css">
  

</head>

<body>


  
    <span id="toolbox-mobile" class="toolbox-mobile">ğŸ†</span>
  

  <div class="post-header CENTER">
   
  <div class="toolbox">
    <a class="toolbox-entry" href="/">
      <span class="toolbox-entry-text">ğŸ†</span>
      <i class="icon-angle-down"></i>
      <i class="icon-home"></i>
    </a>
    <ul class="list-toolbox">
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/archives/"
            rel="noopener noreferrer"
            target="_self"
            >
            åšå®¢
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/categories/"
            rel="noopener noreferrer"
            target="_self"
            >
            åˆ†ç±»
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/tag/"
            rel="noopener noreferrer"
            target="_self"
            >
            æ ‡ç­¾
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/link/"
            rel="noopener noreferrer"
            target="_self"
            >
            å‹é“¾
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/about/"
            rel="noopener noreferrer"
            target="_self"
            >
            å…³äº
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/atom.xml"
            rel="noopener noreferrer"
            target="_blank"
            >
            RSS
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/search/"
            rel="noopener noreferrer"
            target="_self"
            >
            æœç´¢
          </a>
        </li>
      
    </ul>
  </div>


</div>


  <div id="toc" class="toc-article">
    <strong class="toc-title">Posts List</strong>
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#zookeeper-java-api-ä»‹ç»"><span class="toc-text">zookeeper java-api ä»‹ç»</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#åŸç”Ÿ"><span class="toc-text">åŸç”Ÿ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#å¼•åŒ…"><span class="toc-text">å¼•åŒ…</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#åˆ›å»ºæˆ‘ä»¬çš„è¿æ¥"><span class="toc-text">åˆ›å»ºæˆ‘ä»¬çš„è¿æ¥</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#æµç¨‹åˆ†æ"><span class="toc-text">æµç¨‹åˆ†æ</span></a></li></ol></li></ol></li></ol>
  </div>



<div class="content content-post CENTER">
   <article id="post-zookeeper-java-api-ä»‹ç»" class="article article-type-post" itemprop="blogPost">
  <header class="article-header">
    <h1 class="post-title">zookeeper java-api ä»‹ç»</h1>

    <div class="article-meta">
      <span>
        <i class="icon-calendar"></i>
        <span>2019.03.04</span>
      </span>

      
        <span class="article-author">
          <i class="icon-user"></i>
          <span>MurasakiSeiFu.</span>
        </span>
      

      
  <span class="article-category">
    <i class="icon-list"></i>
    <a class="article-category-link" href="/categories/åˆ†å¸ƒå¼ä¸“é¢˜/">åˆ†å¸ƒå¼ä¸“é¢˜</a>
  </span>



      

      
      <i class="fa fa-eye"></i> 
        <span id="busuanzi_container_page_pv">
           &nbspçƒ­åº¦ <span id="busuanzi_value_page_pv">
           <i class="fa fa-spinner fa-spin"></i></span>â„ƒ
        </span>
      
      
    </div>
  </header>

  <div class="article-content">
    
      <meta name="referrer" content="no-referrer">

<h1 id="zookeeper-java-api-ä»‹ç»"><a href="#zookeeper-java-api-ä»‹ç»" class="headerlink" title="zookeeper java-api ä»‹ç»"></a>zookeeper java-api ä»‹ç»</h1><h2 id="åŸç”Ÿ"><a href="#åŸç”Ÿ" class="headerlink" title="åŸç”Ÿ"></a>åŸç”Ÿ</h2><h3 id="å¼•åŒ…"><a href="#å¼•åŒ…" class="headerlink" title="å¼•åŒ…"></a>å¼•åŒ…</h3><p>é¦–å…ˆæˆ‘ä»¬å¼•å…¥gradleã€‚</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">compile</span> <span class="string">'org.apache.zookeeper:zookeeper:3.4.10'</span></span><br></pre></td></tr></table></figure>
<h3 id="åˆ›å»ºæˆ‘ä»¬çš„è¿æ¥"><a href="#åˆ›å»ºæˆ‘ä»¬çš„è¿æ¥" class="headerlink" title="åˆ›å»ºæˆ‘ä»¬çš„è¿æ¥"></a>åˆ›å»ºæˆ‘ä»¬çš„è¿æ¥</h3><ol>
<li><p>æˆ‘ä»¬å…ˆåˆ›å»ºä¸€ä¸ªç±»ï¼Œç±»åï¼šZookeeperCrudï¼Œç„¶ååˆ›å»ºä¸€ä¸ªæ„é€ å‡½æ•°ã€‚</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: murasakiseifu</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span>: 2019-02-27 15:26&#125;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span>: V1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@review</span>: murasakiseifu/2019-02-27 15:26&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ZookeeperCrud</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ZookeeperCrud</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        ZooKeeper zooKeeper = <span class="keyword">new</span> ZooKeeper(...);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<ol start="2">
<li><p>æˆ‘ä»¬ä¼šå‘ç°ï¼Œåˆ›å»ºzookeeperè¿æ¥ï¼Œéœ€è¦ä¸‰ä¸ªå‚æ•°ï¼Œæˆ‘ä»¬è¿›åˆ°ZooKeeper.javaç±»ä¸­ï¼Œçœ‹ä¸€çœ‹è¿™ä¸‰ä¸ªå‚æ•°æ˜¯ä»€ä¹ˆã€‚</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">public ZooKeeper(String connectString, int sessionTimeout, Watcher watcher)</span><br><span class="line">       throws IOException</span><br><span class="line">   &#123;</span><br><span class="line">       this(connectString, sessionTimeout, watcher, false);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<p> åœ¨æºç ä¸Šæœ‰å¯¹è¿™ä¸‰ä¸ªå‚æ•°çš„è¯¦è§£ï¼Œåœ¨è¿™é‡Œç®€å•è¯´ä¸€ä¸‹å‰ä¸¤ä¸ªï¼Œwatcheræˆ‘ä»¬ä¸€ä¼šå†è¯´ã€‚</p>
<p> <strong>String connectStringï¼š</strong><br> åˆ›å»ºZookeeperå®¢æˆ·ç«¯å¯¹è±¡ï¼Œåº”ç”¨ç¨‹åºéœ€è¦ä¼ é€’ä¸€ä¸ªString connectStringï¼Œå…¶ä¸­åŒ…å«é€—å·åˆ†éš”çš„hostï¼športä¸ºä¸€å¯¹çš„åˆ—è¡¨ï¼Œæ¯ä¸€å¯¹å¯¹åº”ä¸€ä¸ªzookeeperæœåŠ¡å™¨ã€‚<br> <strong>int sessionTimeoutï¼š</strong><br> sessionä¼šè¯çš„è¶…æ—¶æ—¶é—´ï¼Œé»˜è®¤å•ä½ä¸ºæ¯«ç§’ã€‚</p>
</li>
<li><p>æœ€ç»ˆè¿æ¥zookeeperæœåŠ¡çš„ä»£ç ã€‚</p>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">public class ZookeeperCrud &#123;</span><br><span class="line"></span><br><span class="line">    String connectString = &quot;192.168.187.200:2181,192.168.187.201:2181,192.168.187.202:2181&quot;;</span><br><span class="line"></span><br><span class="line">    public ZookeeperCrud() &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            ZooKeeper zooKeeper = new ZooKeeper(connectString, 5000, null);</span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        ZookeeperCrud zookeeperCrud = new ZookeeperCrud();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>   æˆåŠŸè¿æ¥çš„æ—¥å¿—</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[2019-02-27 15:58:24] [INFO] Client environment:zookeeper.version=3.4.10-39d3a4f269333c922ed3db283be479f9deacaa0f, built on 03/23/2017 10:13 GMT</span><br><span class="line">  [2019-02-27 15:58:24] [INFO] Client environment:host.name=192.168.187.1</span><br><span class="line">  [2019-02-27 15:58:24] [INFO] Client environment:java.version=1.8.0_144</span><br><span class="line">  [2019-02-27 15:58:24] [INFO] Client environment:java.vendor=Oracle Corporation</span><br><span class="line">  [2019-02-27 15:58:24] [INFO] Client environment:java.home=/Library/Java/JavaVirtualMachines/jdk1.8.0_144.jdk/Contents/Home/jre</span><br><span class="line">  [2019-02-27 15:58:24] [INFO] Client environment:java.class.path=......</span><br><span class="line">  [2019-02-27 15:58:24] [INFO] Client environment:java.library.path=/Users/murasakiseifu/Library/Java/Extensions:/Library/Java/Extensions:/Network/Library/Java/Extensions:/System/Library/Java/Extensions:/usr/lib/java:.</span><br><span class="line">  [2019-02-27 15:58:24] [INFO] Client environment:java.io.tmpdir=/var/folders/60/s3wc1nqj74xfjb63z688j6k40000gn/T/</span><br><span class="line">  [2019-02-27 15:58:24] [INFO] Client environment:java.compiler=&lt;NA&gt;</span><br><span class="line">  [2019-02-27 15:58:24] [INFO] Client environment:os.name=Mac OS X</span><br><span class="line">  [2019-02-27 15:58:24] [INFO] Client environment:os.arch=x86_64</span><br><span class="line">  [2019-02-27 15:58:24] [INFO] Client environment:os.version=10.14</span><br><span class="line">  [2019-02-27 15:58:24] [INFO] Client environment:user.name=murasakiseifu</span><br><span class="line">  [2019-02-27 15:58:24] [INFO] Client environment:user.home=/Users/murasakiseifu</span><br><span class="line">  [2019-02-27 15:58:24] [INFO] Client environment:user.dir=/Users/murasakiseifu/my-project/zookeeper-java-api</span><br><span class="line">  [2019-02-27 15:58:24] [INFO] Initiating client connection, connectString=192.168.187.200:2181,192.168.187.201:2181,192.168.187.202:2181 sessionTimeout=5000 watcher=null</span><br></pre></td></tr></table></figure>
<h3 id="æµç¨‹åˆ†æ"><a href="#æµç¨‹åˆ†æ" class="headerlink" title="æµç¨‹åˆ†æ"></a>æµç¨‹åˆ†æ</h3><p><strong>ä½¿ç”¨å·¥å…·å¾ˆç®€å•ï¼Œé‡è¦çš„æ˜¯ä¸ºä»€ä¹ˆè¿™ä¸ªå·¥å…·å¯ä»¥è¿™ä¹ˆç”¨ã€‚</strong><br>ä¸ºä»€ä¹ˆä¸Šè¿°ä»£ç èƒ½è¿æ¥zkï¼Œæˆ‘ä»¬å¸¦ç€è¿™ä¸ªé—®é¢˜å»æŸ¥ä¸€ä¸‹zookeeperçš„æºç ã€‚å…¶å®å¾ˆç®€å•ã€‚</p>
<ol>
<li><p>æˆ‘ä»¬å®ç°äº†é€šè¿‡javaå®¢æˆ·ç«¯è¿æ¥zookeeperå®¢æˆ·ç«¯ã€‚æˆ‘ä»¬æƒ³è¦çœ‹æ‡‚æ˜¯å¦‚ä½•è¿æ¥ï¼Œå¯ä»¥ç‚¹åˆ°æºç é‡Œä¸€ç‚¹ä¸€ç‚¹çš„æ‰¾ï¼Œä½†æ˜¯è¿™æ ·å¾ˆéº»çƒ¦ï¼Œè€Œä¸”æ•ˆç‡ä½ã€‚çœ‹æºç è¦å¸¦ç€é—®é¢˜å»çœ‹ï¼Œæˆ‘ä»¬æ€è€ƒï¼Œjavaè¿æ¥zookeeperå®¢æˆ·ç«¯è‚¯å®šæ˜¯å°è£…äº†ä¸€å±‚ï¼Œé‚£ä¹ˆä»€ä¹ˆæ–¹å¼æ˜¯ç›´æ¥å°±èƒ½è¿æ¥zookeeperæœåŠ¡å™¨çš„å‘¢ï¼Ÿ<font color="red">Zookeeperè‡ªå·±çš„å®¢æˆ·ç«¯å•Š</font>ï¼Œæˆ‘ä»¬ç›´æ¥æŸ¥çœ‹zkCli.shçš„è„šæœ¬ï¼Œçœ‹çœ‹é‡Œé¢æœ‰ä»€ä¹ˆã€‚</p>
 <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@murasakiseifu bin]# vim zkCli.sh</span><br><span class="line">ZOOBIN="$&#123;BASH_SOURCE-$0&#125;"</span><br><span class="line">ZOOBIN="$(dirname "$&#123;ZOOBIN&#125;")"</span><br><span class="line">ZOOBINDIR="$(cd "$&#123;ZOOBIN&#125;"; pwd)"</span><br><span class="line"></span><br><span class="line">if [ -e "$ZOOBIN/../libexec/zkEnv.sh" ]; then</span><br><span class="line">  . "$ZOOBINDIR"/../libexec/zkEnv.sh</span><br><span class="line">else</span><br><span class="line">  . "$ZOOBINDIR"/zkEnv.sh</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">"$JAVA" "-Dzookeeper.log.dir=$&#123;ZOO_LOG_DIR&#125;" "-Dzookeeper.root.logger=$&#123;ZOO_LOG4J_PROP&#125;" \</span><br><span class="line">     -cp "$CLASSPATH" $CLIENT_JVMFLAGS $JVMFLAGS \</span><br><span class="line">     org.apache.zookeeper.ZooKeeperMain "$@"</span><br><span class="line">~</span><br></pre></td></tr></table></figure>
</li>
<li><p>é™¤å»æ³¨é‡Šï¼Œæˆ‘ä»¬çœ‹åˆ°è¿™ä¸ªè„šæœ¬é‡Œæœ‰ä¸€ä¸ªæˆ‘ä»¬ç†Ÿæ‚‰çš„ï¼šorg.apache.zookeeper.ZooKeeperMainï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°è¿™ä¸ªç±»ï¼Œå»çœ‹çœ‹æœ‰ä»€ä¹ˆ.ï¼ˆç±»é‡Œçš„ä»£ç å¾ˆå¤šï¼Œæˆ‘ä»¬æŒ‘é€‰å‡ ä¸ªå¸¸è§çš„ï¼‰</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ZooKeeperMain</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">static</span> <span class="keyword">final</span> Map&lt;String,String&gt; commandMap = <span class="keyword">new</span> HashMap&lt;String,String&gt;( );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> MyCommandOptions cl = <span class="keyword">new</span> MyCommandOptions();</span><br><span class="line">    <span class="keyword">protected</span> HashMap&lt;Integer,String&gt; history = <span class="keyword">new</span> HashMap&lt;Integer,String&gt;( );</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">int</span> commandCount = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">boolean</span> printWatches = <span class="keyword">true</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> ZooKeeper zk;</span><br><span class="line">    <span class="keyword">protected</span> String host = <span class="string">""</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">getPrintWatches</span><span class="params">( )</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> printWatches;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        commandMap.put(<span class="string">"connect"</span>, <span class="string">"host:port"</span>);</span><br><span class="line">        commandMap.put(<span class="string">"close"</span>,<span class="string">""</span>);</span><br><span class="line">        commandMap.put(<span class="string">"create"</span>, <span class="string">"[-s] [-e] path data acl"</span>);</span><br><span class="line">        commandMap.put(<span class="string">"delete"</span>,<span class="string">"path [version]"</span>);</span><br><span class="line">        commandMap.put(<span class="string">"rmr"</span>,<span class="string">"path"</span>);</span><br><span class="line">        commandMap.put(<span class="string">"set"</span>,<span class="string">"path data [version]"</span>);</span><br><span class="line">        commandMap.put(<span class="string">"get"</span>,<span class="string">"path [watch]"</span>);</span><br><span class="line">        commandMap.put(<span class="string">"ls"</span>,<span class="string">"path [watch]"</span>);</span><br><span class="line">        commandMap.put(<span class="string">"ls2"</span>,<span class="string">"path [watch]"</span>);</span><br><span class="line">        commandMap.put(<span class="string">"getAcl"</span>,<span class="string">"path"</span>);</span><br><span class="line">        commandMap.put(<span class="string">"setAcl"</span>,<span class="string">"path acl"</span>);</span><br><span class="line">        commandMap.put(<span class="string">"stat"</span>,<span class="string">"path [watch]"</span>);</span><br><span class="line">        commandMap.put(<span class="string">"sync"</span>,<span class="string">"path"</span>);</span><br><span class="line">        commandMap.put(<span class="string">"setquota"</span>,<span class="string">"-n|-b val path"</span>);</span><br><span class="line">        commandMap.put(<span class="string">"listquota"</span>,<span class="string">"path"</span>);</span><br><span class="line">        commandMap.put(<span class="string">"delquota"</span>,<span class="string">"[-n|-b] path"</span>);</span><br><span class="line">        commandMap.put(<span class="string">"history"</span>,<span class="string">""</span>);</span><br><span class="line">        commandMap.put(<span class="string">"redo"</span>,<span class="string">"cmdno"</span>);</span><br><span class="line">        commandMap.put(<span class="string">"printwatches"</span>, <span class="string">"on|off"</span>);</span><br><span class="line">        commandMap.put(<span class="string">"quit"</span>,<span class="string">""</span>);</span><br><span class="line">        commandMap.put(<span class="string">"addauth"</span>, <span class="string">"scheme auth"</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>staticé™æ€ä»£ç å—é‡Œçš„ï¼Œå°±æ˜¯åœ¨zkClientæ‰§è¡Œhelpå‘½ä»¤çš„ä¿¡æ¯ã€‚</p>
<pre><code><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">	[zk: localhost:2181(CONNECTED) 0] help</span><br><span class="line">	ZooKeeper -server host:port cmd args</span><br><span class="line">	        stat path [watch]</span><br><span class="line">	        set path data [version]</span><br><span class="line">	        ls path [watch]</span><br><span class="line">	        delquota [-n|-b] path</span><br><span class="line">	        ls2 path [watch]</span><br><span class="line">	        setAcl path acl</span><br><span class="line">	        setquota -n|-b val path</span><br><span class="line">	        history </span><br><span class="line">	        redo cmdno</span><br><span class="line">	        printwatches on|off</span><br><span class="line">	        delete path [version]</span><br><span class="line">	        sync path</span><br><span class="line">	        listquota path</span><br><span class="line">	        rmr path</span><br><span class="line">	        get path [watch]</span><br><span class="line">	        create [-s] [-e] path data acl</span><br><span class="line">	        addauth scheme auth</span><br><span class="line">	        quit </span><br><span class="line">	        getAcl path</span><br><span class="line">	        close </span><br><span class="line">	        connect host:port</span><br><span class="line">```	</span><br><span class="line"></span><br><span class="line">å†æ¯”å¦‚è¿™ä¸ªã€‚</span><br><span class="line"></span><br><span class="line">```java</span><br><span class="line">private static void printStat(Stat stat) &#123;</span><br><span class="line">       System.err.println(&quot;cZxid = 0x&quot; + Long.toHexString(stat.getCzxid()));</span><br><span class="line">       System.err.println(&quot;ctime = &quot; + new Date(stat.getCtime()).toString());</span><br><span class="line">       System.err.println(&quot;mZxid = 0x&quot; + Long.toHexString(stat.getMzxid()));</span><br><span class="line">       System.err.println(&quot;mtime = &quot; + new Date(stat.getMtime()).toString());</span><br><span class="line">       System.err.println(&quot;pZxid = 0x&quot; + Long.toHexString(stat.getPzxid()));</span><br><span class="line">       System.err.println(&quot;cversion = &quot; + stat.getCversion());</span><br><span class="line">       System.err.println(&quot;dataVersion = &quot; + stat.getVersion());</span><br><span class="line">       System.err.println(&quot;aclVersion = &quot; + stat.getAversion());</span><br><span class="line">       System.err.println(&quot;ephemeralOwner = 0x&quot;</span><br><span class="line">       		+ Long.toHexString(stat.getEphemeralOwner()));</span><br><span class="line">       System.err.println(&quot;dataLength = &quot; + stat.getDataLength());</span><br><span class="line">       System.err.println(&quot;numChildren = &quot; + stat.getNumChildren());</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

å¯¹åº”çš„å°±æ˜¯èŠ‚ç‚¹çš„statçŠ¶æ€ä¿¡æ¯ã€‚

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[zk: localhost:2181(CONNECTED) 1] get /murasaki</span><br><span class="line">666</span><br><span class="line">cZxid = 0x400000002</span><br><span class="line">ctime = Thu Feb 21 10:53:25 CST 2019</span><br><span class="line">mZxid = 0x800000003</span><br><span class="line">mtime = Fri Feb 22 00:59:05 CST 2019</span><br><span class="line">pZxid = 0x400000003</span><br><span class="line">cversion = 1</span><br><span class="line">dataVersion = 1</span><br><span class="line">aclVersion = 0</span><br><span class="line">ephemeralOwner = 0x0</span><br><span class="line">dataLength = 3</span><br><span class="line">numChildren = 1</span><br></pre></td></tr></table></figure>
</code></pre><ol start="3">
<li><p>ZooKeeperMain ç±»å°±æ˜¯æˆ‘ä»¬è¦æ‰¾çš„æ ¸å¿ƒç±»ï¼Œåœ¨è¿™ä¸ªç±»é‡Œé¢æœ‰ä¸€ä¸ªmainæ–¹æ³•ã€‚</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String args[])</span></span></span><br><span class="line"><span class="function">       <span class="keyword">throws</span> KeeperException, IOException, InterruptedException</span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">       ZooKeeperMain main = <span class="keyword">new</span> ZooKeeperMain(args);</span><br><span class="line">       main.run();</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>è¿™ä¸ªmainæ–¹æ³•é‡Œåˆ›å»ºäº†ä¸€ä¸ªZooKeeperMainå¯¹è±¡ï¼Œæˆ‘ä»¬ä¾ç„¶ç‚¹è¿›å»ã€‚</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">ZooKeeperMain</span><span class="params">(String args[])</span> <span class="keyword">throws</span> IOException, InterruptedException </span>&#123;</span><br><span class="line">        cl.parseOptions(args);</span><br><span class="line">        System.out.println(<span class="string">"Connecting to "</span> + cl.getOption(<span class="string">"server"</span>));</span><br><span class="line">        connectToZK(cl.getOption(<span class="string">"server"</span>));</span><br><span class="line">        <span class="comment">//zk = new ZooKeeper(cl.getOption("server"),</span></span><br><span class="line"><span class="comment">//                Integer.parseInt(cl.getOption("timeout")), new MyWatcher());</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<pre><code>çœ‹æœ‰æ ‡å¿—æ€§çš„ä»£ç ï¼ŒconnectToZK(cl.getOption(&quot;server&quot;));è¿æ¥zkï¼Œè¿™æ­£æ˜¯æˆ‘ä»¬æƒ³è¦æ‰¾çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æ¥ç€ç‚¹è¿›å»ã€‚

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">connectToZK</span><span class="params">(String newHost)</span> <span class="keyword">throws</span> InterruptedException, IOException </span>&#123;</span><br><span class="line">       <span class="keyword">if</span> (zk != <span class="keyword">null</span> &amp;&amp; zk.getState().isAlive()) &#123;</span><br><span class="line">           zk.close();</span><br><span class="line">       &#125;</span><br><span class="line">       host = newHost;</span><br><span class="line">       <span class="keyword">boolean</span> readOnly = cl.getOption(<span class="string">"readonly"</span>) != <span class="keyword">null</span>;</span><br><span class="line">       zk = <span class="keyword">new</span> ZooKeeper(host,</span><br><span class="line">                Integer.parseInt(cl.getOption(<span class="string">"timeout"</span>)),</span><br><span class="line">                <span class="keyword">new</span> MyWatcher(), readOnly);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>


çœ‹ï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†æœ€ç»ˆçš„è¿æ¥zk = new ZooKeeper(...);
</code></pre><p><strong>æˆ‘ä»¬æ—¢ç„¶è¦æ‰§è¡Œapiçš„crudï¼Œæˆ‘ä»¬å°±å†æ‰¾ä¸€ä¸‹createæ–¹æ³•</strong>    </p>
<ol>
<li><p>é¦–å…ˆæˆ‘ä»¬å…¨å±€æœç´¢createå…³é”®å­—ï¼Œæˆ‘ä»¬ä¼šå‘ç°æœ‰å¾ˆå¤šæ–¹æ³•ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªæŠ€å·§ï¼Œçœ‹å¸¦æœ‰è¿”å›å€¼çš„æ–¹æ³•ã€‚</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">createQuota</span><span class="params">(ZooKeeper zk, String path,</span></span></span><br><span class="line"><span class="function"><span class="params">           <span class="keyword">long</span> bytes, <span class="keyword">int</span> numNodes)</span></span></span><br><span class="line"><span class="function">       <span class="keyword">throws</span> KeeperException, IOException, InterruptedException </span>&#123;</span><br><span class="line">   &#125;</span><br><span class="line">```	</span><br><span class="line"></span><br><span class="line">é‡Œé¢ä»£ç å¾ˆå¤šï¼Œæˆ‘ä»¬å°±ä¸ä¸€ä¸€åˆ—ä¸¾äº†ï¼ŒæŸ¥çœ‹æºç æˆ‘ä»¬ä¼šå‘ç°æœ‰ä¸€æ®µä»£ç ï¼š</span><br><span class="line"></span><br><span class="line">```java</span><br><span class="line"><span class="keyword">if</span> (zk.exists(quotaPath, <span class="keyword">false</span>) == <span class="keyword">null</span>) &#123;</span><br><span class="line">       <span class="keyword">try</span> &#123;</span><br><span class="line">           zk.create(Quotas.procZookeeper, <span class="keyword">null</span>, Ids.OPEN_ACL_UNSAFE,</span><br><span class="line">                   CreateMode.PERSISTENT);</span><br><span class="line">           zk.create(Quotas.quotaZookeeper, <span class="keyword">null</span>, Ids.OPEN_ACL_UNSAFE,</span><br><span class="line">                   CreateMode.PERSISTENT);</span><br><span class="line">       &#125; <span class="keyword">catch</span>(KeeperException.NodeExistsException ne) &#123;</span><br><span class="line">           <span class="comment">// do nothing</span></span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<ol start="2">
<li><p>é‡Œé¢çš„zk.createå¾ˆåƒæˆ‘ä»¬è¦æ‰¾çš„ä»£ç ï¼Œç‚¹è¿›å»ä¼šå‘ç°è¿™å°±æ˜¯åˆ›å»ºèŠ‚ç‚¹çš„æ–¹æ³•ï¼Œéœ€è¦æˆ‘ä»¬æä¾›å››ä¸ªå‚æ•°ï¼šè·¯å¾„ã€æ•°æ®ã€æƒé™é›†åˆã€åˆ›å»ºçš„èŠ‚ç‚¹ç±»å‹ã€‚</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">create</span><span class="params">(<span class="keyword">final</span> String path, <span class="keyword">byte</span> data[], List&lt;ACL&gt; acl,</span></span></span><br><span class="line"><span class="function"><span class="params">           CreateMode createMode)</span></span></span><br><span class="line"><span class="function">       <span class="keyword">throws</span> KeeperException, InterruptedException</span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">   </span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>æˆ‘ä»¬ä¸ä¸€ä¸€åˆ—ä¸¾zookeeperå…¶ä»–æ–¹æ³•äº†ï¼Œå¤§å®¶æŒ‰ç…§è¿™ä¸ªæ–¹æ³•å°±éƒ½èƒ½æ‰¾åˆ°ï¼Œè€Œä¸”åœ¨å¯»æ‰¾çš„è¿‡ç¨‹ä¸­ï¼Œä¹Ÿèƒ½çŸ¥é“ä¸€äº›zookeeper javaæ–¹æ³•çš„ä¸€äº›ä½¿ç”¨æ–¹å¼ã€‚</p>
<p><strong>åˆ›å»ºæŒä¹…èŠ‚ç‚¹</strong>    </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºæŒä¹…èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@author</span> MurasakiSeiFu</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@date</span> 2019-02-28 10:16</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>: [path, data]</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span>: java.lang.String</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">createPersistent</span><span class="params">(String path, String data)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> zookeeper.create(path, data.getBytes(), ZooDefs.Ids.OPEN_ACL_UNSAFE, CreateMode.PERSISTENT);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (KeeperException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">```	</span><br><span class="line">	</span><br><span class="line">ZooDefs.Ids.OPEN_ACL_UNSAFE ä¸ºæƒé™è®¾ç½®ã€‚	</span><br><span class="line"></span><br><span class="line">CreateMode.PERSISTENT ä¸ºèŠ‚ç‚¹ç±»å‹è®¾ç½®ï¼Œå¦‚æœæˆ‘ä»¬è¦å»ºç«‹ä¸´æ—¶èŠ‚ç‚¹ï¼Œå°±æŠŠå®ƒè®¾ç½®ä¸ºCreateMode.EPHEMERAL å°±å¯ä»¥äº†ã€‚</span><br><span class="line">	</span><br><span class="line">**è·å–ä¿¡æ¯**</span><br><span class="line"></span><br><span class="line">```java</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@author</span> MurasakiSeiFu</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@date</span> 2019-02-28 10:46</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>: [path]</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span>: java.lang.String</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getData</span><span class="params">(String path)</span> <span class="keyword">throws</span> KeeperException, InterruptedException </span>&#123;</span><br><span class="line">        <span class="keyword">byte</span> data[] = zookeeper.getData(path, <span class="keyword">false</span>, <span class="keyword">null</span>);</span><br><span class="line">        data = (data == <span class="keyword">null</span>) ? <span class="string">"null"</span>.getBytes() : data;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> String(data);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p><strong>æ›´æ–°ä¿¡æ¯</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">   * æ›´æ–°ä¿¡æ¯</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@author</span> FuZizheng</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@date</span> 2019-02-28 11:01</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span>: [path, data]</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@return</span>: org.apache.zookeeper.data.Stat</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Stat <span class="title">setData</span><span class="params">(String path, String data)</span> <span class="keyword">throws</span> KeeperException, InterruptedException </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> zookeeper.setData(path, data.getBytes(), -<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p><strong>åˆ é™¤èŠ‚ç‚¹</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åˆ é™¤èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> MurasakiSeiFu</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2019-02-28 11:03</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span>: [path]</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span>: void</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteData</span><span class="params">(String path)</span> <span class="keyword">throws</span> KeeperException, InterruptedException </span>&#123;</span><br><span class="line">    zookeeper.delete(path, -<span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>é€’å½’åˆ é™¤èŠ‚ç‚¹</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é€’å½’åˆ é™¤èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@author</span> FuZizheng</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@date</span> 2019-02-28 11:05</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>: [path]</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span>: void</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteRecursive</span><span class="params">(String path)</span> <span class="keyword">throws</span> KeeperException, InterruptedException </span>&#123;</span><br><span class="line">        ZKUtil.deleteRecursive(zookeeper, path);</span><br><span class="line">    &#125;</span><br><span class="line">```	</span><br><span class="line">	</span><br><span class="line">### watchäº‹ä»¶</span><br><span class="line"></span><br><span class="line">ä¸Šè¿°æ˜¯æœ€ç®€å•çš„apiï¼Œç°åœ¨æˆ‘ä»¬è¦è®²ä¸€ä¸‹watchäº‹ä»¶ã€‚	åŸºæœ¬å’Œä¸Šè¿°çš„ä»£ç å·®ä¸å¤šã€‚</span><br><span class="line"></span><br><span class="line">**å®ç° Watcheræ¥å£**</span><br><span class="line"></span><br><span class="line">```java</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ZookeeperWatchCrud</span> <span class="keyword">implements</span> <span class="title">Watcher</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">process</span><span class="params">(WatchedEvent event)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åŸºç¡€å‡†å¤‡å’Œä¹‹å‰ä¸€æ ·ï¼Œæä¾›é›†ç¾¤ä¿¡æ¯ã€‚ç¨åŠ ä¿®æ”¹å’Œå®Œå–„ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ZookeeperWatchCrud</span> <span class="keyword">implements</span> <span class="title">Watcher</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String connectString = <span class="string">"192.168.187.200:2181,192.168.187.201:2181,192.168.187.202:2181"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> ZooKeeper zookeeper;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ZookeeperWatchCrud</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            zookeeper = <span class="keyword">new</span> ZooKeeper(connectString, <span class="number">5000</span>, <span class="keyword">this</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">process</span><span class="params">(WatchedEvent event)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// è¿æ¥çŠ¶æ€</span></span><br><span class="line">        Event.KeeperState keeperState = event.getState();</span><br><span class="line">        <span class="comment">// äº‹ä»¶ç±»å‹</span></span><br><span class="line">        Event.EventType eventType = event.getType();</span><br><span class="line">        <span class="comment">// å—å½±å“çš„path</span></span><br><span class="line">        String path = event.getPath();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">"è¿æ¥çŠ¶æ€:"</span> + keeperState + <span class="string">",äº‹ä»¶ç±»å‹ï¼š"</span> + eventType + <span class="string">",å—å½±å“çš„path:"</span> + path);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ZookeeperWatchCrud zookeeperWatchCrud = <span class="keyword">new</span> ZookeeperWatchCrud();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å’Œä¹‹å‰ä¸åŒï¼Œè¿™æ¬¡æ§åˆ¶å°æ²¡æœ‰æŠ¥é”™ã€‚watcher=watch.ZookeeperWatchCrud@42110406</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[2019-02-28 11:29:25] [INFO] Client environment:zookeeper.version=3.4.10-39d3a4f269333c922ed3db283be479f9deacaa0f, built on 03/23/2017 10:13 GMT</span><br><span class="line"> [2019-02-28 11:29:25] [INFO] Client environment:host.name=172.16.191.1</span><br><span class="line"> [2019-02-28 11:29:25] [INFO] Client environment:java.version=1.8.0_144</span><br><span class="line"> [2019-02-28 11:29:25] [INFO] Client environment:java.vendor=Oracle Corporation</span><br><span class="line"> [2019-02-28 11:29:25] [INFO] Client environment:java.home=/Library/Java/JavaVirtualMachines/jdk1.8.0_144.jdk/Contents/Home/jre</span><br><span class="line"> [2019-02-28 11:29:25] [INFO] Client environment:java.class.path=...</span><br><span class="line"> [2019-02-28 11:29:25] [INFO] Client environment:java.library.path=/Users/murasakiseifu/Library/Java/Extensions:/Library/Java/Extensions:/Network/Library/Java/Extensions:/System/Library/Java/Extensions:/usr/lib/java:.</span><br><span class="line"> [2019-02-28 11:29:25] [INFO] Client environment:java.io.tmpdir=/var/folders/60/s3wc1nqj74xfjb63z688j6k40000gn/T/</span><br><span class="line"> [2019-02-28 11:29:25] [INFO] Client environment:java.compiler=&lt;NA&gt;</span><br><span class="line"> [2019-02-28 11:29:25] [INFO] Client environment:os.name=Mac OS X</span><br><span class="line"> [2019-02-28 11:29:25] [INFO] Client environment:os.arch=x86_64</span><br><span class="line"> [2019-02-28 11:29:25] [INFO] Client environment:os.version=10.14</span><br><span class="line"> [2019-02-28 11:29:25] [INFO] Client environment:user.name=murasakiseifu</span><br><span class="line"> [2019-02-28 11:29:25] [INFO] Client environment:user.home=/Users/murasakiseifu</span><br><span class="line"> [2019-02-28 11:29:25] [INFO] Client environment:user.dir=/Users/murasakiseifu/my-project/zookeeper-java-api</span><br><span class="line"> [2019-02-28 11:29:25] [INFO] Initiating client connection, connectString=192.168.187.200:2181,192.168.187.201:2181,192.168.187.202:2181 sessionTimeout=5000 watcher=watch.ZookeeperWatchCrud@42110406</span><br><span class="line"> </span><br><span class="line">Process finished with exit code 0</span><br></pre></td></tr></table></figure>
<p>å…¶ä½™ä»£ç ç›¸åŒï¼Œåªåœ¨getDataå’Œexitsä¸¤ä¸ªæ–¹æ³•ï¼ŒåŠ ä¸Šwatcherã€‚</p>
<p><strong>è·å–ä¿¡æ¯</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> path</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> KeeperException</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> InterruptedException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getData</span><span class="params">(String path, <span class="keyword">boolean</span> watcher)</span> <span class="keyword">throws</span> KeeperException, InterruptedException </span>&#123;</span><br><span class="line">        <span class="keyword">byte</span> data[] = zookeeper.getData(path, watcher, <span class="keyword">null</span>);</span><br><span class="line">        data = (data == <span class="keyword">null</span>) ? <span class="string">"null"</span>.getBytes() : data;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> String(data);</span><br><span class="line">    &#125;</span><br><span class="line">```	</span><br><span class="line"></span><br><span class="line">**æ˜¯å¦å­˜åœ¨**</span><br><span class="line">	</span><br><span class="line">```java</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ˜¯å¦å­˜åœ¨</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> path</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> KeeperException</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> InterruptedException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Stat <span class="title">exists</span><span class="params">(String path, <span class="keyword">boolean</span> watcher)</span> <span class="keyword">throws</span> KeeperException, InterruptedException </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> zookeeper.exists(path, watcher);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>åŠ ä¸Šç›‘å¬ä¹‹åï¼Œæˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹proccessæ–¹æ³•ï¼Œä»¥æ–¹ä¾¿æˆ‘ä»¬åšç›‘å¬ã€‚ä¸€ä¼šæµ‹è¯•ç±»ä¸­æ–°å»ºçš„èŠ‚ç‚¹è·¯å¾„ä¸º/watcher,åœ¨processæ–¹æ³•æŠŠè¿™ä¸ªè·¯å¾„å†™æ­»äº†ï¼Œæ–¹ä¾¿æµ‹è¯• -ã€‚-</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">process</span><span class="params">(WatchedEvent event)</span> </span>&#123;</span><br><span class="line">       <span class="comment">// è¿æ¥çŠ¶æ€</span></span><br><span class="line">       Event.KeeperState keeperState = event.getState();</span><br><span class="line">       <span class="comment">// äº‹ä»¶ç±»å‹</span></span><br><span class="line">       Event.EventType eventType = event.getType();</span><br><span class="line">       <span class="comment">// å—å½±å“çš„path</span></span><br><span class="line">       String path = event.getPath();</span><br><span class="line"></span><br><span class="line">       System.out.println(<span class="string">"è¿æ¥çŠ¶æ€:"</span> + keeperState + <span class="string">",äº‹ä»¶ç±»å‹ï¼š"</span> + eventType + <span class="string">",å—å½±å“çš„path:"</span> + path);</span><br><span class="line"></span><br><span class="line">       <span class="comment">//step:2</span></span><br><span class="line">       <span class="keyword">try</span> &#123;</span><br><span class="line">           <span class="keyword">if</span> (<span class="keyword">null</span> != <span class="keyword">this</span>.exists(<span class="string">"/watcher"</span>, <span class="keyword">true</span>)) &#123;</span><br><span class="line">               System.out.println(<span class="string">"å†…å®¹:"</span> + <span class="keyword">this</span>.getData(<span class="string">"/watcher"</span>, <span class="keyword">true</span>));</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">       &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">           e.printStackTrace();</span><br><span class="line">       &#125;</span><br><span class="line">       System.out.println(<span class="string">"--------------------"</span>);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å†™ä¸€ä¸ªæµ‹è¯•ç±»è¯•ä¸€ä¸‹æ•ˆæœã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> KeeperException, InterruptedException </span>&#123;</span><br><span class="line">    ZookeeperWatchCrud zookeeperWatchCrud = <span class="keyword">new</span> ZookeeperWatchCrud();</span><br><span class="line">    <span class="comment">//åˆ›å»ºèŠ‚ç‚¹</span></span><br><span class="line">    zookeeperWatchCrud.createPersistent(<span class="string">"/watcher"</span>,<span class="string">"watcher test"</span>);</span><br><span class="line">    <span class="comment">//ä¸ºwatcherèŠ‚ç‚¹æ³¨å†Œç›‘å¬ï¼Œå¹¶ä¸”è¾“å‡ºå½“å‰å†…å®¹</span></span><br><span class="line">    System.out.println(zookeeperWatchCrud.getData(<span class="string">"/watcher"</span>, <span class="keyword">true</span>));</span><br><span class="line">    <span class="comment">//ä¿®æ”¹watcherèŠ‚ç‚¹æ•°æ®</span></span><br><span class="line">    zookeeperWatchCrud.setData(<span class="string">"/watcher"</span>,<span class="string">"change data"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ§åˆ¶å°è¾“å‡º</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">è¿æ¥çŠ¶æ€:SyncConnected,äº‹ä»¶ç±»å‹ï¼šNone,å—å½±å“çš„path:null</span><br><span class="line">watcher test</span><br><span class="line">å†…å®¹:change data</span><br><span class="line">--------------------</span><br><span class="line">è¿æ¥çŠ¶æ€:SyncConnected,äº‹ä»¶ç±»å‹ï¼šNodeDataChanged,å—å½±å“çš„path:/watcher</span><br></pre></td></tr></table></figure>

    
  </div>

</article>


   
  <div class="text-center donation">
    <div class="inner-donation">
      <span class="btn-donation">æ”¯æŒä¸€ä¸‹</span>
      <div class="donation-body">
        <div class="tip text-center">æ‰«ä¸€æ‰«ï¼Œæ”¯æŒforsigner</div>
        <ul>
        
          <li class="item">
            
              <span>å¾®ä¿¡æ‰«ä¸€æ‰«</span>
            
            <img src="/images/qr-wechat.png" alt="">
          </li>
        
          <li class="item">
            
              <span>æ”¯ä»˜å®æ‰«ä¸€æ‰«</span>
            
            <img src="/images/qr-alipay.png" alt="">
          </li>
        
        </ul>
      </div>
    </div>
  </div>


   
  <div class="box-prev-next clearfix">
    <a class="show pull-left" href="/2019/02/27/zookeeperå®¢æˆ·ç«¯è¯¦è§£/">
        <i class="icon icon-angle-left"></i>
    </a>
    <a class="show pull-right" href="/2019/03/07/redis-å®‰è£…-åŸºç¡€å‘½ä»¤-æŒä¹…åŒ–æ¦‚å¿µ/">
        <i class="icon icon-angle-right"></i>
    </a>
  </div>




</div>


  <a id="backTop" class="back-top">
    <i class="icon-angle-up"></i>
  </a>




  <div class="modal" id="modal">
  <span id="cover" class="cover hide"></span>
  <div id="modal-dialog" class="modal-dialog hide-dialog">
    <div class="modal-header">
      <span id="close" class="btn-close">å…³é—­</span>
    </div>
    <hr>
    <div class="modal-body">
      <ul class="list-toolbox">
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/archives/"
              rel="noopener noreferrer"
              target="_self"
              >
              åšå®¢
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/categories/"
              rel="noopener noreferrer"
              target="_self"
              >
              åˆ†ç±»
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/tag/"
              rel="noopener noreferrer"
              target="_self"
              >
              æ ‡ç­¾
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/link/"
              rel="noopener noreferrer"
              target="_self"
              >
              å‹é“¾
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/about/"
              rel="noopener noreferrer"
              target="_self"
              >
              å…³äº
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/atom.xml"
              rel="noopener noreferrer"
              target="_blank"
              >
              RSS
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/search/"
              rel="noopener noreferrer"
              target="_self"
              >
              æœç´¢
            </a>
          </li>
        
      </ul>

    </div>
  </div>
</div>



  
      <div class="fexo-comments comments-post">
    

    

    
    

    

    
    

    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src="//cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js"></script>
    <div id="comment" class="vcomment" ></div>
    <script>
        var notify = 'false' == true ? true : false;
        var verify = 'false' == true ? true : false;
        var GUEST_INFO = ['nick','mail','link'];
        var guest_info = 'nick,mail,link'.split(',').filter(function(item){
            return GUEST_INFO.indexOf(item) > -1
        });
        guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;
        window.valine = new Valine({
            el: '.vcomment',
            notify: notify,
            verify: verify,
            appId: "9cprXYUH7H1YKlRERiGS8bxV-gzGzoHsz",
            appKey: "et0Drv2jnj4ILMBUSaNM2M2R",
            avatar:'mm',
            placeholder: "Talk to me ^_^",
            guest_info:guest_info,
            pageSize:'10'
        });
    </script>
  
    

  </div>

  

  <script type="text/javascript">
  function loadScript(url, callback) {
    var script = document.createElement('script')
    script.type = 'text/javascript';

    if (script.readyState) { //IE
      script.onreadystatechange = function() {
        if (script.readyState == 'loaded' ||
          script.readyState == 'complete') {
          script.onreadystatechange = null;
          callback();
        }
      };
    } else { //Others
      script.onload = function() {
        callback();
      };
    }

    script.src = url;
    document.getElementsByTagName('head')[0].appendChild(script);
  }

  window.onload = function() {
    loadScript('/js/bundle.js?235683', function() {
      // load success
    });
  }
</script>

</body>
</html>
