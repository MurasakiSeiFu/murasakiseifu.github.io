<!DOCTYPE html>


  <html class="dark page-post">


<head>
  <meta charset="utf-8">
  <meta name="referrer" content="no-referrer" />
  
  <title>Nginx æ ¸å¿ƒæ¨¡å—ä¸é…ç½®å®è·µ | MurasakiSeiFu</title>

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
    <meta name="keywords" content="java,redis,nginx,zookeeper,åˆ†å¸ƒå¼ä¸­é—´ä»¶,å¾®æœåŠ¡,springboot,mysql" />
  

  <meta name="description" content="Nginx ç®€ä»‹ä¸å®‰è£…1ã€Nginxç®€ä»‹ï¼šNginxæ˜¯ä¸€ä¸ªé«˜æ€§èƒ½WEBæœåŠ¡å™¨ï¼Œé™¤å®ƒä¹‹å¤–Apacheã€Tomcatã€Jettyã€IISï¼Œå®ƒä»¬éƒ½æ˜¯WebæœåŠ¡å™¨ï¼Œæˆ–è€…å«åšWWWï¼ˆWorld Wide Webï¼‰æœåŠ¡å™¨ï¼Œç›¸åº”åœ°ä¹Ÿéƒ½å…·å¤‡WebæœåŠ¡å™¨çš„åŸºæœ¬åŠŸèƒ½ã€‚Nginx  ç›¸å¯¹åŸºå®ƒWEBæœåŠ¡æœ‰ä»€ä¹ˆä¼˜åŠ¿å‘¢ï¼Ÿ  Tomcatã€Jetty é¢å‘javaè¯­è¨€ï¼Œå…ˆå¤©å°±æ˜¯é‡é‡çº§çš„WEBæœåŠ¡å™¨ï¼Œå…¶æ€§èƒ½ä¸Nginxæ²¡æœ‰å¯">
<meta property="og:type" content="article">
<meta property="og:title" content="Nginx æ ¸å¿ƒæ¨¡å—ä¸é…ç½®å®è·µ">
<meta property="og:url" content="http://ilovenorth.life/2018/10/15/Nginx-æ ¸å¿ƒæ¨¡å—ä¸é…ç½®å®è·µ/index.html">
<meta property="og:site_name" content="MurasakiSeiFu">
<meta property="og:description" content="Nginx ç®€ä»‹ä¸å®‰è£…1ã€Nginxç®€ä»‹ï¼šNginxæ˜¯ä¸€ä¸ªé«˜æ€§èƒ½WEBæœåŠ¡å™¨ï¼Œé™¤å®ƒä¹‹å¤–Apacheã€Tomcatã€Jettyã€IISï¼Œå®ƒä»¬éƒ½æ˜¯WebæœåŠ¡å™¨ï¼Œæˆ–è€…å«åšWWWï¼ˆWorld Wide Webï¼‰æœåŠ¡å™¨ï¼Œç›¸åº”åœ°ä¹Ÿéƒ½å…·å¤‡WebæœåŠ¡å™¨çš„åŸºæœ¬åŠŸèƒ½ã€‚Nginx  ç›¸å¯¹åŸºå®ƒWEBæœåŠ¡æœ‰ä»€ä¹ˆä¼˜åŠ¿å‘¢ï¼Ÿ  Tomcatã€Jetty é¢å‘javaè¯­è¨€ï¼Œå…ˆå¤©å°±æ˜¯é‡é‡çº§çš„WEBæœåŠ¡å™¨ï¼Œå…¶æ€§èƒ½ä¸Nginxæ²¡æœ‰å¯">
<meta property="og:locale" content="default">
<meta property="og:image" content="https://ws2.sinaimg.cn/large/006tNbRwly1fw8rpn1pmdj30i30f4dgq.jpg">
<meta property="og:image" content="https://ws4.sinaimg.cn/large/006tNbRwly1fw8w7tipm3j30q80gbwfh.jpg">
<meta property="og:image" content="https://ws3.sinaimg.cn/large/006tNbRwly1fw8w9tfiktj31280kc78n.jpg">
<meta property="og:updated_time" content="2019-04-29T01:57:10.750Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Nginx æ ¸å¿ƒæ¨¡å—ä¸é…ç½®å®è·µ">
<meta name="twitter:description" content="Nginx ç®€ä»‹ä¸å®‰è£…1ã€Nginxç®€ä»‹ï¼šNginxæ˜¯ä¸€ä¸ªé«˜æ€§èƒ½WEBæœåŠ¡å™¨ï¼Œé™¤å®ƒä¹‹å¤–Apacheã€Tomcatã€Jettyã€IISï¼Œå®ƒä»¬éƒ½æ˜¯WebæœåŠ¡å™¨ï¼Œæˆ–è€…å«åšWWWï¼ˆWorld Wide Webï¼‰æœåŠ¡å™¨ï¼Œç›¸åº”åœ°ä¹Ÿéƒ½å…·å¤‡WebæœåŠ¡å™¨çš„åŸºæœ¬åŠŸèƒ½ã€‚Nginx  ç›¸å¯¹åŸºå®ƒWEBæœåŠ¡æœ‰ä»€ä¹ˆä¼˜åŠ¿å‘¢ï¼Ÿ  Tomcatã€Jetty é¢å‘javaè¯­è¨€ï¼Œå…ˆå¤©å°±æ˜¯é‡é‡çº§çš„WEBæœåŠ¡å™¨ï¼Œå…¶æ€§èƒ½ä¸Nginxæ²¡æœ‰å¯">
<meta name="twitter:image" content="https://ws2.sinaimg.cn/large/006tNbRwly1fw8rpn1pmdj30i30f4dgq.jpg">

  

  
    <link rel="icon" href="/images/favicon.ico">
  

  <link href="/css/styles.css?v=c114cbeddx" rel="stylesheet">


  
    <link rel="stylesheet" href="/css/personal-style.css">
  

  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-86660611-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


  
  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?2e6da3c375c8a87f5b664cea6d4cb29c";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>


  
  <script type="text/javascript">
	(function(){
	    var bp = document.createElement('script');
	    var curProtocol = window.location.protocol.split(':')[0];
	    if (curProtocol === 'https') {
	        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
	    }
	    else {
	        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
	    }
	    var s = document.getElementsByTagName("script")[0];
	    s.parentNode.insertBefore(bp, s);
	})();
  </script>



  
    <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.3.0/css/font-awesome.min.css">
  

</head>

<body>


  
    <span id="toolbox-mobile" class="toolbox-mobile">ğŸ†</span>
  

  <div class="post-header CENTER">
   
  <div class="toolbox">
    <a class="toolbox-entry" href="/">
      <span class="toolbox-entry-text">ğŸ†</span>
      <i class="icon-angle-down"></i>
      <i class="icon-home"></i>
    </a>
    <ul class="list-toolbox">
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/archives/"
            rel="noopener noreferrer"
            target="_self"
            >
            åšå®¢
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/categories/"
            rel="noopener noreferrer"
            target="_self"
            >
            åˆ†ç±»
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/tag/"
            rel="noopener noreferrer"
            target="_self"
            >
            æ ‡ç­¾
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/link/"
            rel="noopener noreferrer"
            target="_self"
            >
            å‹é“¾
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/about/"
            rel="noopener noreferrer"
            target="_self"
            >
            å…³äº
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/atom.xml"
            rel="noopener noreferrer"
            target="_blank"
            >
            RSS
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/search/"
            rel="noopener noreferrer"
            target="_self"
            >
            æœç´¢
          </a>
        </li>
      
    </ul>
  </div>


</div>


  <div id="toc" class="toc-article">
    <strong class="toc-title">Posts List</strong>
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Nginx-ç®€ä»‹ä¸å®‰è£…"><span class="toc-text">Nginx ç®€ä»‹ä¸å®‰è£…</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1ã€Nginxç®€ä»‹ï¼š"><span class="toc-text">1ã€Nginxç®€ä»‹ï¼š</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2ã€ç¼–è¯‘ä¸å®‰è£…"><span class="toc-text">2ã€ç¼–è¯‘ä¸å®‰è£…</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#äºŒã€Nginx-æ¶æ„è¯´æ˜"><span class="toc-text">äºŒã€Nginx æ¶æ„è¯´æ˜</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ä¸‰ã€Nginx-é…ç½®ä¸ä½¿ç”¨"><span class="toc-text">ä¸‰ã€Nginx é…ç½®ä¸ä½¿ç”¨</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ä¸»è¦å†…å®¹"><span class="toc-text">ä¸»è¦å†…å®¹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1ã€é…ç½®æ–‡ä»¶çš„è¯­æ³•æ ¼å¼ï¼š"><span class="toc-text">1ã€é…ç½®æ–‡ä»¶çš„è¯­æ³•æ ¼å¼ï¼š</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2ã€é…ç½®ç¬¬ä¸€ä¸ªé™æ€WEBæœåŠ¡"><span class="toc-text">2ã€é…ç½®ç¬¬ä¸€ä¸ªé™æ€WEBæœåŠ¡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3ã€æ—¥å¿—é…ç½®ï¼š"><span class="toc-text">3ã€æ—¥å¿—é…ç½®ï¼š</span></a></li></ol></li></ol></li></ol>
  </div>



<div class="content content-post CENTER">
   <article id="post-Nginx-æ ¸å¿ƒæ¨¡å—ä¸é…ç½®å®è·µ" class="article article-type-post" itemprop="blogPost">
  <header class="article-header">
    <h1 class="post-title">Nginx æ ¸å¿ƒæ¨¡å—ä¸é…ç½®å®è·µ</h1>

    <div class="article-meta">
      <span>
        <i class="icon-calendar"></i>
        <span>2018.10.15</span>
      </span>

      
        <span class="article-author">
          <i class="icon-user"></i>
          <span>MurasakiSeiFu.</span>
        </span>
      

      
  <span class="article-category">
    <i class="icon-list"></i>
    <a class="article-category-link" href="/categories/åˆ†å¸ƒå¼ä¸“é¢˜/">åˆ†å¸ƒå¼ä¸“é¢˜</a>
  </span>



      

      
      <i class="fa fa-eye"></i> 
        <span id="busuanzi_container_page_pv">
           &nbspçƒ­åº¦ <span id="busuanzi_value_page_pv">
           <i class="fa fa-spinner fa-spin"></i></span>â„ƒ
        </span>
      
      
    </div>
  </header>

  <div class="article-content">
    
      <meta name="referrer" content="no-referrer">

<h1 id="Nginx-ç®€ä»‹ä¸å®‰è£…"><a href="#Nginx-ç®€ä»‹ä¸å®‰è£…" class="headerlink" title="Nginx ç®€ä»‹ä¸å®‰è£…"></a>Nginx ç®€ä»‹ä¸å®‰è£…</h1><h2 id="1ã€Nginxç®€ä»‹ï¼š"><a href="#1ã€Nginxç®€ä»‹ï¼š" class="headerlink" title="1ã€Nginxç®€ä»‹ï¼š"></a>1ã€Nginxç®€ä»‹ï¼š</h2><p>Nginxæ˜¯ä¸€ä¸ªé«˜æ€§èƒ½WEBæœåŠ¡å™¨ï¼Œé™¤å®ƒä¹‹å¤–Apacheã€Tomcatã€Jettyã€IISï¼Œå®ƒä»¬éƒ½æ˜¯WebæœåŠ¡å™¨ï¼Œæˆ–è€…å«åšWWWï¼ˆWorld Wide Webï¼‰æœåŠ¡å™¨ï¼Œç›¸åº”åœ°ä¹Ÿéƒ½å…·å¤‡WebæœåŠ¡å™¨çš„åŸºæœ¬åŠŸèƒ½ã€‚Nginx  ç›¸å¯¹åŸºå®ƒWEBæœåŠ¡æœ‰ä»€ä¹ˆä¼˜åŠ¿å‘¢ï¼Ÿ</p>
<ol>
<li>Tomcatã€Jetty é¢å‘javaè¯­è¨€ï¼Œå…ˆå¤©å°±æ˜¯é‡é‡çº§çš„WEBæœåŠ¡å™¨ï¼Œå…¶æ€§èƒ½ä¸Nginxæ²¡æœ‰å¯æ¯”æ€§ã€‚</li>
<li>IISåªèƒ½åœ¨Windowsæ“ä½œç³»ç»Ÿä¸Šè¿è¡Œã€‚Windowsä½œä¸ºæœåŠ¡å™¨åœ¨ç¨³å®šæ€§ä¸å…¶ä»–ä¸€äº›æ€§èƒ½ä¸Šéƒ½ä¸å¦‚ç±»UNIXæ“ä½œç³»ç»Ÿï¼Œå› æ­¤ï¼Œåœ¨éœ€è¦é«˜æ€§èƒ½WebæœåŠ¡å™¨çš„åœºåˆä¸‹IISå¹¶ä¸å ä¼˜ã€‚</li>
<li>Apacheçš„å‘å±•æ—¶æœŸå¾ˆé•¿ï¼Œè€Œä¸”æ˜¯ç›®å‰æ¯«æ— äº‰è®®çš„ä¸–ç•Œç¬¬ä¸€å¤§WebæœåŠ¡å™¨ï¼Œå…¶æœ‰è®¸å¤šä¼˜ç‚¹ï¼Œå¦‚ç¨³å®šã€å¼€æºã€è·¨å¹³å°ç­‰ï¼Œä½†å®ƒå‡ºç°çš„æ—¶é—´å¤ªé•¿äº†ï¼Œåœ¨å®ƒå…´èµ·çš„å¹´ä»£ï¼Œäº’è”ç½‘çš„äº§ä¸šè§„æ¨¡è¿œè¿œæ¯”ä¸ä¸Šä»Šå¤©ï¼Œæ‰€ä»¥å®ƒè¢«è®¾è®¡æˆäº†ä¸€ä¸ªé‡é‡çº§çš„ã€ä¸æ”¯æŒé«˜å¹¶å‘çš„WebæœåŠ¡å™¨ã€‚åœ¨ApacheæœåŠ¡å™¨ä¸Šï¼Œå¦‚æœæœ‰æ•°ä»¥ä¸‡è®¡çš„å¹¶å‘HTTPè¯·æ±‚åŒæ—¶è®¿é—®ï¼Œå°±ä¼šå¯¼è‡´æœåŠ¡å™¨ä¸Šæ¶ˆè€—å¤§é‡å†…å­˜ï¼Œæ“ä½œç³»ç»Ÿå†…æ ¸å¯¹æˆç™¾ä¸Šåƒçš„Apacheè¿›ç¨‹åšè¿›ç¨‹é—´åˆ‡æ¢ä¹Ÿä¼šæ¶ˆè€—å¤§é‡CPUèµ„æºï¼Œå¹¶å¯¼è‡´HTTPè¯·æ±‚çš„å¹³å‡å“åº”é€Ÿåº¦é™ä½ï¼Œè¿™äº›éƒ½å†³å®šäº†Apacheä¸å¯èƒ½æˆä¸ºé«˜æ€§èƒ½WebæœåŠ¡å™¨ï¼Œè¿™ä¹Ÿä¿ƒä½¿äº†Lighttpdå’ŒNginxçš„å‡ºç°ã€‚ ä¸‹å›¾å¯ä»¥çœ‹å‡º07å¹´åˆ°17 å¹´å¼ºåŠ²å¢é•¿åŠ¿å¤´ã€‚<br><img src="https://ws2.sinaimg.cn/large/006tNbRwly1fw8rpn1pmdj30i30f4dgq.jpg" alt=""></li>
</ol>
<h2 id="2ã€ç¼–è¯‘ä¸å®‰è£…"><a href="#2ã€ç¼–è¯‘ä¸å®‰è£…" class="headerlink" title="2ã€ç¼–è¯‘ä¸å®‰è£…"></a><strong>2ã€ç¼–è¯‘ä¸å®‰è£…</strong></h2><p><strong>å®‰è£…ç¯å¢ƒå‡†å¤‡ï¼š</strong><br><strong>ï¼ˆ1ï¼‰linux å†…æ ¸2.6åŠä»¥ä¸Šç‰ˆæœ¬:</strong><br>åªæœ‰2.6ä¹‹åæ‰æ”¯æŒepool ï¼Œåœ¨æ­¤ä¹‹å‰ä½¿ç”¨selectæˆ–poolå¤šè·¯å¤ç”¨çš„IOæ¨¡å‹ï¼Œæ— æ³•è§£å†³é«˜å¹¶å‘å‹åŠ›çš„é—®é¢˜ã€‚é€šè¿‡å‘½ä»¤uname -a å³å¯æŸ¥çœ‹ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#æŸ¥çœ‹ linux å†…æ ¸</span><br><span class="line">uname -a</span><br></pre></td></tr></table></figure></p>
<p><strong>ï¼ˆ2ï¼‰GCCç¼–è¯‘å™¨</strong><br>GCCï¼ˆGNU Compiler Collectionï¼‰å¯ç”¨æ¥ç¼–è¯‘Cè¯­è¨€ç¨‹åºã€‚Nginxä¸ä¼šç›´æ¥æä¾›äºŒè¿›åˆ¶å¯æ‰§è¡Œç¨‹åº,åªèƒ½ä¸‹è½½æºç è¿›è¡Œç¼–è¯‘ã€‚</p>
<p><strong>ï¼ˆ3ï¼‰PCREåº“</strong><br>PCREï¼ˆPerl Compatible Regular Expressionsï¼ŒPerlå…¼å®¹æ­£åˆ™è¡¨è¾¾å¼ï¼‰æ˜¯ç”±Philip Hazelå¼€å‘çš„å‡½æ•°åº“ï¼Œç›®å‰ä¸ºå¾ˆå¤šè½¯ä»¶æ‰€ä½¿ç”¨ï¼Œè¯¥åº“æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼ã€‚</p>
<p><strong>ï¼ˆ4ï¼‰zlibåº“</strong><br>zlibåº“ç”¨äºå¯¹HTTPåŒ…çš„å†…å®¹åšgzipæ ¼å¼çš„å‹ç¼©ï¼Œå¦‚æœæˆ‘ä»¬åœ¨nginx.confé‡Œé…ç½®äº†gzip onï¼Œå¹¶æŒ‡å®šå¯¹äºæŸäº›ç±»å‹ï¼ˆcontent-typeï¼‰çš„HTTPå“åº”ä½¿ç”¨gzipæ¥è¿›è¡Œå‹ç¼©ä»¥å‡å°‘ç½‘ç»œä¼ è¾“é‡ã€‚</p>
<p><strong>ï¼ˆ5ï¼‰OpenSSLå¼€å‘åº“</strong><br>å¦‚æœæˆ‘ä»¬çš„æœåŠ¡å™¨ä¸åªæ˜¯è¦æ”¯æŒHTTPï¼Œè¿˜éœ€è¦åœ¨æ›´å®‰å…¨çš„SSLåè®®ä¸Šä¼ è¾“HTTPï¼Œé‚£ä¹ˆå°±éœ€è¦æ‹¥æœ‰OpenSSLäº†ã€‚å¦å¤–ï¼Œå¦‚æœæˆ‘ä»¬æƒ³ä½¿ç”¨MD5ã€SHA1ç­‰æ•£åˆ—å‡½æ•°ï¼Œé‚£ä¹ˆä¹Ÿéœ€è¦å®‰è£…å®ƒã€‚<br>ä¸Šé¢å‡ ä¸ªåº“éƒ½æ˜¯Nginx åŸºç¡€åŠŸèƒ½æ‰€å¿…éœ€çš„ï¼Œä¸ºç®€å•èµ·è§æˆ‘ä»¬å¯ä»¥é€šè¿‡yum å‘½ä»¤ç»Ÿä¸€å®‰è£…ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#yum å®‰è£…nginx ç¯å¢ƒ</span><br><span class="line">yum -y install make zlib zlib-devel gcc-c++ libtool openssl openssl-devel pcre pcre-devel</span><br></pre></td></tr></table></figure>
<p><strong>æºç è·å–ï¼š</strong><br>nginx ä¸‹è½½é¡µï¼š<a href="http://nginx.org/en/download.html" target="_blank" rel="noopener">http://nginx.org/en/download.html</a> ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># ä¸‹è½½nginx æœ€æ–°ç¨³å®šç‰ˆæœ¬</span><br><span class="line">wget http://nginx.org/download/nginx-1.14.0.tar.gz</span><br><span class="line">#è§£å‹</span><br><span class="line">tar -zxvf nginx-1.14.0.tar.gz</span><br></pre></td></tr></table></figure></p>
<p>æœ€ç®€å•çš„å®‰è£…ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># å…¨éƒ¨é‡‡ç”¨é»˜è®¤å®‰è£…</span><br><span class="line">./configure</span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure></p>
<p>æ‰§è¡Œå®Œæˆä¹‹å nginx è¿è¡Œæ–‡ä»¶ å°±ä¼šè¢«å®‰è£…åœ¨ /usr/local/nginx ä¸‹ã€‚</p>
<p>åŸºäºå‚æ•°æ„å»º<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">./configure --prefix=/usr/local/nginx --with-http_stub_status_module --with-http_ssl_module --with-debug</span><br><span class="line">make</span><br><span class="line">è¿›å…¥objsæ–‡ä»¶å¤¹ ä¼šç”Ÿæˆnginxæ–‡ä»¶ æˆ‘ä»¬éœ€è¦ç”¨å®ƒæ›¿æ¢æ‰/usr/local/nginx/sbin/ä¸‹çš„nginxæ–‡ä»¶</span><br><span class="line">/usr/local/nginx/sbin/nginx -s stop</span><br><span class="line">cp nginx /usr/local/nginx/sbin/</span><br><span class="line">cp: overwrite `/usr/local/nginx/sbin/nginx&apos;? y</span><br></pre></td></tr></table></figure></p>
<p><strong>æ§åˆ¶å‘½ä»¤ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#é»˜è®¤æ–¹å¼å¯åŠ¨ï¼š</span><br><span class="line">./sbin/nginx </span><br><span class="line">#æŒ‡å®šé…ç½®æ–‡ä»¶å¯åŠ¨ </span><br><span class="line">./sbing/nginx -c /tmp/nginx.conf </span><br><span class="line">#æŒ‡å®šnginxç¨‹åºç›®å½•å¯åŠ¨</span><br><span class="line">./sbin/nginx -p /usr/local/nginx/</span><br><span class="line"></span><br><span class="line">#å¿«é€Ÿåœæ­¢ ä¸ç®¡æœ‰æ²¡æœ‰æœªæ‰§è¡Œå®Œçš„è¯·æ±‚ ç›´æ¥åœæ­¢è¿›ç¨‹</span><br><span class="line">./sbin/nginx -s stop</span><br><span class="line">#ä¼˜é›…åœæ­¢ ç­‰å¾…å½“å‰è¯·æ±‚æ‰§è¡Œå®Œ å†åœæ­¢è¿›ç¨‹</span><br><span class="line">./sbin/nginx -s quit</span><br><span class="line">#æ£€æµ‹é…ç½®æ–‡ä»¶æ˜¯å¦æ­£ç¡®</span><br><span class="line">./sbin/nginx -t</span><br><span class="line"></span><br><span class="line"># çƒ­è£…è½½é…ç½®æ–‡ä»¶Â åœ¨ä¸åœæ­¢nginxçš„æƒ…å†µä¸‹æ›´æ–°é…ç½®æ–‡ä»¶</span><br><span class="line">./sbin/nginx -s reload</span><br><span class="line"># é‡æ–°æ‰“å¼€æ—¥å¿—æ–‡ä»¶</span><br><span class="line">./sbin/nginx -s reopen</span><br></pre></td></tr></table></figure></p>
<h2 id="äºŒã€Nginx-æ¶æ„è¯´æ˜"><a href="#äºŒã€Nginx-æ¶æ„è¯´æ˜" class="headerlink" title="äºŒã€Nginx æ¶æ„è¯´æ˜"></a>äºŒã€Nginx æ¶æ„è¯´æ˜</h2><hr>
<p><strong>Nginx æ¶æ„å›¾:</strong><br><img src="https://ws4.sinaimg.cn/large/006tNbRwly1fw8w7tipm3j30q80gbwfh.jpg" alt=""></p>
<p><strong>æ¶æ„è¯´æ˜ï¼š</strong><br>1ï¼‰nginxå¯åŠ¨æ—¶ï¼Œä¼šç”Ÿæˆä¸¤ç§ç±»å‹çš„è¿›ç¨‹ï¼Œä¸€ä¸ªæ˜¯ä¸»è¿›ç¨‹ï¼ˆMasterï¼‰ï¼Œä¸€ä¸ªï¼ˆwindowsç‰ˆæœ¬çš„ç›®å‰åªæœ‰ä¸€ä¸ªï¼‰å’Œå¤šä¸ªå·¥ä½œè¿›ç¨‹ï¼ˆWorkerï¼‰ã€‚ä¸»è¿›ç¨‹å¹¶ä¸å¤„ç†ç½‘ç»œè¯·æ±‚ï¼Œä¸»è¦è´Ÿè´£è°ƒåº¦å·¥ä½œè¿›ç¨‹ï¼Œä¹Ÿå°±æ˜¯å›¾ç¤ºçš„ä¸‰é¡¹ï¼šåŠ è½½é…ç½®ã€å¯åŠ¨å·¥ä½œè¿›ç¨‹åŠéåœå‡çº§ã€‚æ‰€ä»¥ï¼Œnginxå¯åŠ¨ä»¥åï¼ŒæŸ¥çœ‹æ“ä½œç³»ç»Ÿçš„è¿›ç¨‹åˆ—è¡¨ï¼Œæˆ‘ä»¬å°±èƒ½çœ‹åˆ°è‡³å°‘æœ‰ä¸¤ä¸ªnginxè¿›ç¨‹ã€‚</p>
<p>2ï¼‰æœåŠ¡å™¨å®é™…å¤„ç†ç½‘ç»œè¯·æ±‚åŠå“åº”çš„æ˜¯å·¥ä½œè¿›ç¨‹ï¼ˆworkerï¼‰ï¼Œåœ¨ç±»unixç³»ç»Ÿä¸Šï¼Œnginxå¯ä»¥é…ç½®å¤šä¸ªworkerï¼Œè€Œæ¯ä¸ªworkerè¿›ç¨‹éƒ½å¯ä»¥åŒæ—¶å¤„ç†æ•°ä»¥åƒè®¡çš„ç½‘ç»œè¯·æ±‚ã€‚    </p>
<p>3ï¼‰æ¨¡å—åŒ–è®¾è®¡ã€‚nginxçš„workerï¼ŒåŒ…æ‹¬æ ¸å¿ƒå’ŒåŠŸèƒ½æ€§æ¨¡å—ï¼Œæ ¸å¿ƒæ¨¡å—è´Ÿè´£ç»´æŒä¸€ä¸ªè¿è¡Œå¾ªç¯ï¼ˆrun-loopï¼‰ï¼Œæ‰§è¡Œç½‘ç»œè¯·æ±‚å¤„ç†çš„ä¸åŒé˜¶æ®µçš„æ¨¡å—åŠŸèƒ½ï¼Œå¦‚ç½‘ç»œè¯»å†™ã€å­˜å‚¨è¯»å†™ã€å†…å®¹ä¼ è¾“ã€å¤–å‡ºè¿‡æ»¤ï¼Œä»¥åŠå°†è¯·æ±‚å‘å¾€ä¸Šæ¸¸æœåŠ¡å™¨ç­‰ã€‚è€Œå…¶ä»£ç çš„æ¨¡å—åŒ–è®¾è®¡ï¼Œä¹Ÿä½¿å¾—æˆ‘ä»¬å¯ä»¥æ ¹æ®éœ€è¦å¯¹åŠŸèƒ½æ¨¡å—è¿›è¡Œé€‚å½“çš„é€‰æ‹©å’Œä¿®æ”¹ï¼Œç¼–è¯‘æˆå…·æœ‰ç‰¹å®šåŠŸèƒ½çš„æœåŠ¡å™¨ã€‚</p>
<p>4ï¼‰äº‹ä»¶é©±åŠ¨ã€å¼‚æ­¥åŠéé˜»å¡ï¼Œå¯ä»¥è¯´æ˜¯nginxå¾—ä»¥è·å¾—é«˜å¹¶å‘ã€é«˜æ€§èƒ½çš„å…³é”®å› ç´ ï¼ŒåŒæ—¶ä¹Ÿå¾—ç›Šäºå¯¹Linuxã€SolarisåŠç±»BSDç­‰æ“ä½œç³»ç»Ÿå†…æ ¸ä¸­äº‹ä»¶é€šçŸ¥åŠI/Oæ€§èƒ½å¢å¼ºåŠŸèƒ½çš„é‡‡ç”¨ï¼Œå¦‚kqueueã€epollåŠevent portsã€‚</p>
<p><strong>ç®€å•è¯´æ˜æµç¨‹:</strong><br><img src="https://ws3.sinaimg.cn/large/006tNbRwly1fw8w9tfiktj31280kc78n.jpg" alt=""><br>æ­£å¸¸æµç¨‹ï¼šæµè§ˆå™¨å‘é€è¯·æ±‚â€”&gt;è¿æ¥åˆ°ç½‘å¡â€”&gt;å†…æ ¸ä»ç¡¬ç›˜è¯»å–Htmlæ–‡ä»¶åˆ°å†…æ ¸æ€â€”&gt;å†…æ ¸å†æŠŠæ–‡ä»¶å‘é€åˆ°nginxåº”ç”¨æ€â€”&gt;åº”ç”¨æ€åœ¨å¤åˆ¶åˆ°ç½‘å¡</p>
<p>æœ€æ—©çš„nginxçš„æµç¨‹ï¼šé€šè¿‡eqoll/select IOæ¨¡å‹æ¥å®Œæˆéé˜»å¡ï¼Œæ‰€æœ‰éœ€è¦I/Oæ“ä½œçš„è¿›ç¨‹è¿›å…¥seleté˜Ÿåˆ—ã€‚nginxä¼šè½®è¯¢é˜Ÿåˆ—æ˜¯å¦æœ‰I/Oè¿›ç¨‹ï¼Œå¦‚æœæœ‰ï¼Œå†å»ç¡¬ç›˜è¯»å†™ã€‚</p>
<p>ç°åœ¨ï¼šå¦‚æœè½®è¯¢éœ€è¦10ä¸‡ä¸ªï¼Œä¹Ÿæ˜¯å¾ˆè€—æ—¶é—´çš„ï¼Œæ‰€ä»¥åœ¨å†…æ ¸é‡Œä¼šå¢åŠ ä¸€ä¸ªäº‹ä»¶ï¼Œé€šè¿‡AIOçš„æ–¹å¼ï¼Œä¸éœ€è¦è½®è¯¢ï¼Œå½“æœ‰å¯è¯»å¯å†™çš„I/Oæ—¶ï¼Œä¸é€šè¿‡selectï¼Œå†…æ ¸è‡ªå·±æ¥é€šçŸ¥nginxï¼Œnginxåœ¨é€šè¿‡è¿›ä¸€æ­¥çš„é…ç½®ï¼Œå†…æ ¸æ€å°±å¯ä»¥ä¸ç»è¿‡nginxç›´æ¥åˆ°ç½‘å¡ã€‚</p>
<h2 id="ä¸‰ã€Nginx-é…ç½®ä¸ä½¿ç”¨"><a href="#ä¸‰ã€Nginx-é…ç½®ä¸ä½¿ç”¨" class="headerlink" title="ä¸‰ã€Nginx é…ç½®ä¸ä½¿ç”¨"></a>ä¸‰ã€Nginx é…ç½®ä¸ä½¿ç”¨</h2><h3 id="ä¸»è¦å†…å®¹"><a href="#ä¸»è¦å†…å®¹" class="headerlink" title="ä¸»è¦å†…å®¹"></a><strong>ä¸»è¦å†…å®¹</strong></h3><ol>
<li>é…ç½®æ–‡ä»¶è¯­æ³•æ ¼å¼</li>
<li>é…ç½®ç¬¬ä¸€ä¸ªé™æ€WEBæœåŠ¡</li>
<li>é…ç½®æ¡ˆä¾‹<ol>
<li>åŠ¨é™åˆ†ç¦»å®ç°</li>
<li>é˜²ç›—é“¾</li>
<li>å¤šåŸŸåç«™ç‚¹</li>
<li>ä¸‹è½½é™é€Ÿ</li>
<li>IP é»‘åå•</li>
<li>åŸºäºuser-agentåˆ†æµ</li>
</ol>
</li>
<li>æ—¥å¿—é…ç½®<h3 id="1ã€é…ç½®æ–‡ä»¶çš„è¯­æ³•æ ¼å¼ï¼š"><a href="#1ã€é…ç½®æ–‡ä»¶çš„è¯­æ³•æ ¼å¼ï¼š" class="headerlink" title="1ã€é…ç½®æ–‡ä»¶çš„è¯­æ³•æ ¼å¼ï¼š"></a><strong>1ã€é…ç½®æ–‡ä»¶çš„è¯­æ³•æ ¼å¼ï¼š</strong></h3>å…ˆæ¥çœ‹ä¸€ä¸ªç®€å•çš„nginx é…ç½®<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">worker_processes  1;</span><br><span class="line">events &#123;</span><br><span class="line">Â  Â  worker_connectionsÂ  1024;</span><br><span class="line">&#125;</span><br><span class="line">http &#123;</span><br><span class="line">Â  Â  includeÂ  Â  Â  Â mime.types;</span><br><span class="line">Â  Â  default_typeÂ  application/octet-stream;</span><br><span class="line">    # å¼€å¯å å†…æ ¸æ€å°±å¯ä»¥ä¸ç»è¿‡nginxç›´æ¥å‘é€æ–‡ä»¶åˆ°ç½‘å¡ã€‚</span><br><span class="line">Â  Â  sendfileÂ  Â  Â  Â  on;</span><br><span class="line">    # é•¿è¿æ¥ä¿æ´»æ—¶é—´</span><br><span class="line">Â  Â  keepalive_timeoutÂ  65;</span><br><span class="line">    </span><br><span class="line">    # ä»£è¡¨è™šæ‹Ÿæœº</span><br><span class="line">Â  Â  server &#123;</span><br><span class="line">    	# ç›‘å¬ç«¯å£(ä¸è¦é‡å¤)</span><br><span class="line">Â  Â  Â  Â  listenÂ  Â  Â  Â 80;</span><br><span class="line">        # é…ç½®åŸŸå</span><br><span class="line">Â  Â  Â  Â  server_nameÂ  localhost;</span><br><span class="line">        # è¯·æ±‚åœ°å€</span><br><span class="line">Â  Â  Â  Â  location / &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  rootÂ  Â html;</span><br><span class="line">Â  Â  Â  Â  Â  Â  indexÂ  index.html index.htm;</span><br><span class="line">Â  Â  Â  Â  &#125;</span><br><span class="line">        location /nginx_status &#123;</span><br><span class="line">Â  Â  	Â  Â stub_status on;</span><br><span class="line">Â  Â  	Â  Â access_logÂ  Â off;</span><br><span class="line">  	    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>ä¸Šè¿°é…ç½®ä¸­çš„eventsã€httpã€serverã€locationã€upstreamç­‰å±äºé…ç½®é¡¹å—ã€‚<br>è€Œworker_processes ã€worker_connectionsã€includeã€listen  å±äºé…ç½®é¡¹å—ä¸­çš„å±æ€§ã€‚<br>/nginx_statusï¼šå±äºé…ç½®å—çš„ç‰¹å®šå‚æ•°å‚æ•°ã€‚å…¶ä¸­serverå—åµŒå¥—äºhttpå—ï¼Œå…¶å¯ä»¥ç›´æ¥ç»§æ‰¿è®¿é—®Httpå—å½“ä¸­çš„å‚æ•°ã€‚<br>| <strong>é…ç½®å—</strong>   | åç§°å¼€å¤´ç”¨å¤§å£å·åŒ…è£¹å…¶å¯¹åº”å±æ€§   |<br>|:â€”-|:â€”-|<br>| <strong>å±æ€§</strong>   | åŸºäºç©ºæ ¼åˆ‡åˆ†å±æ€§åä¸å±æ€§å€¼ï¼Œå±æ€§å€¼å¯èƒ½æœ‰å¤šä¸ªé¡¹ éƒ½ä»¥ç©ºæ ¼è¿›è¡Œåˆ‡åˆ† å¦‚ï¼š  access_log  logs/host.access.log  main   |<br>| <strong>å‚æ•°</strong>   | å…¶é…ç½®åœ¨ å—åç§°ä¸å¤§æ‹¬å·é—´ï¼Œå…¶å€¼å¦‚æœæœ‰å¤šä¸ªä¹Ÿæ˜¯é€šè¿‡ç©ºæ ¼è¿›è¡Œæ‹†   | </p>
<p>æ³¨æ„ å¦‚æœé…ç½®é¡¹å€¼ä¸­åŒ…æ‹¬è¯­æ³•ç¬¦å·ï¼Œæ¯”å¦‚ç©ºæ ¼ç¬¦ï¼Œé‚£ä¹ˆéœ€è¦ä½¿ç”¨å•å¼•å·æˆ–åŒå¼•å·æ‹¬ä½é…ç½®é¡¹å€¼ï¼Œå¦åˆ™Nginxä¼šæŠ¥è¯­æ³•é”™è¯¯ã€‚ä¾‹å¦‚ï¼š<br>    log_format  main  â€˜$remote_addr - $remote_user [$time_local] â€œ$requestâ€ â€˜<br>                     â€˜$status $body_bytes_sent â€œ$http_refererâ€ â€˜<br>                     â€˜â€œ$http_user_agentâ€ â€œ$http_x_forwarded_forâ€â€˜;</p>
<h3 id="2ã€é…ç½®ç¬¬ä¸€ä¸ªé™æ€WEBæœåŠ¡"><a href="#2ã€é…ç½®ç¬¬ä¸€ä¸ªé™æ€WEBæœåŠ¡" class="headerlink" title="2ã€é…ç½®ç¬¬ä¸€ä¸ªé™æ€WEBæœåŠ¡"></a>2ã€é…ç½®ç¬¬ä¸€ä¸ªé™æ€WEBæœåŠ¡</h3><p>åŸºæœ¬é…ç½®ä»‹ç»è¯´æ˜ï¼š<br>ï¼ˆ1ï¼‰ç›‘å¬ç«¯å£<br>è¯­æ³•ï¼šlisten addressï¼š<br>é»˜è®¤ï¼šlisten 80;<br>é…ç½®å—ï¼šserver    </p>
<p>ï¼ˆ2ï¼‰ä¸»æœºåç§°<br>è¯­æ³•ï¼šserver_name name[â€¦â€¦];<br>é»˜è®¤ï¼šserver_name â€œâ€;<br>é…ç½®å—ï¼šserver<br>server_nameåå¯ä»¥è·Ÿå¤šä¸ªä¸»æœºåç§°ï¼Œå¦‚server_name <a href="http://www.testweb.com" target="_blank" rel="noopener">www.testweb.com</a>ã€download.testweb.com;ã€‚ æ”¯æŒé€šé…ç¬¦ä¸æ­£åˆ™</p>
<p>ï¼ˆ3ï¼‰location<br>è¯­æ³•ï¼šlocation[=|ï½|ï½*|^ï½|@]/uri/{â€¦â€¦}<br>é…ç½®å—ï¼šserver</p>
<ol>
<li>/ åŸºäºuriç›®å½•åŒ¹é…</li>
<li>=è¡¨ç¤ºæŠŠURIä½œä¸ºå­—ç¬¦ä¸²ï¼Œä»¥ä¾¿ä¸å‚æ•°ä¸­çš„uriåšå®Œå…¨åŒ¹é…ã€‚</li>
<li>ï½è¡¨ç¤ºæ­£åˆ™åŒ¹é…URIæ—¶æ˜¯å­—æ¯å¤§å°å†™æ•æ„Ÿçš„ã€‚</li>
<li>ï½*è¡¨ç¤ºæ­£åˆ™åŒ¹é…URIæ—¶å¿½ç•¥å­—æ¯å¤§å°å†™é—®é¢˜ã€‚</li>
<li>^ï½è¡¨ç¤ºæ­£åˆ™åŒ¹é…URIæ—¶åªéœ€è¦å…¶å‰åŠéƒ¨åˆ†ä¸uriå‚æ•°åŒ¹é…å³å¯ã€‚</li>
</ol>
<p><strong>åŠ¨é™åˆ†ç¦»ï¼š</strong></p>
<ul>
<li style="list-style: none"><input type="checkbox"> åˆ›å»ºé™æ€ç«™ç‚¹</li>
<li style="list-style: none"><input type="checkbox"> é…ç½® location /static</li>
<li style="list-style: none"><input type="checkbox"> é…ç½® ~* .(gif|png|css|js)$ </li>
</ul>
<p>åŸºäºç›®å½•åŠ¨é™åˆ†ç¦»<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Â  Â server &#123;</span><br><span class="line">Â  Â  Â  Â  listen 80;</span><br><span class="line">Â  Â  Â  Â  server_name *.MurasakiSeiFu.com;</span><br><span class="line">Â  Â  Â  Â  root /usr/www/MurasakiSeiFu;</span><br><span class="line">Â  Â  Â  Â  location / &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  index MurasakiSeiFu.html;</span><br><span class="line">Â  Â  Â  Â  &#125;</span><br><span class="line"># é™æ€èµ„æºé…ç½®</span><br><span class="line"># è®¿é—®/static/***.jpg</span><br><span class="line">Â  Â  Â  Â  location /static &#123;</span><br><span class="line"> # åˆ›å»ºstaticæ–‡ä»¶å¤¹ ç„¶åæ”¾å…¥ä¸€å¼ å›¾ç‰‡ åœ¨è¿™é‡ŒæŒ‡å®šè·¯å¾„</span><br><span class="line">Â  Â  Â  Â  Â alias /usr/www/static;</span><br><span class="line">Â  Â  Â  Â  &#125;</span><br><span class="line">Â &#125;</span><br></pre></td></tr></table></figure></p>
<p>åŸºäºæ­£åˆ™åŠ¨é™åˆ†ç¦»(å¦‚æœé…ç½®æ­£åˆ™è¡¨è¾¾å¼ æœ€å…ˆåŒ¹é…æ­£åˆ™ å…¶æ¬¡æ˜¯static æœ€åæ˜¯ /)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">location ~* \.(gif|jpg|png|css|js)$ &#123;</span><br><span class="line">Â  Â  Â  root /usr/www/static;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>é˜²ç›—é“¾é…ç½®æ¼”ç¤ºï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># åŠ å…¥è‡³æŒ‡å®šlocation å³å¯å®ç°</span><br><span class="line">valid_referers none blocked *.MurasakiSeiFu.com;</span><br><span class="line">Â if ($invalid_referer) &#123;</span><br><span class="line">Â  Â Â Â  Â return 403;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>ä¸‹è½½é™é€Ÿï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">location /download &#123;</span><br><span class="line">Â  Â  limit_rate 1m;</span><br><span class="line">    limit_rate_after 30m;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>åˆ›å»ºIPé»‘åå•: </strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># åˆ›å»ºé»‘åå•æ–‡ä»¶</span><br><span class="line">echo &apos;deny 192.168.0.132;&apos; &gt;&gt; balck.ip</span><br><span class="line">#http é…ç½®å—ä¸­å¼•å…¥ é»‘åå•æ–‡ä»¶</span><br><span class="line">includeÂ  Â  Â  Â black.ip;</span><br></pre></td></tr></table></figure></p>
<h3 id="3ã€æ—¥å¿—é…ç½®ï¼š"><a href="#3ã€æ—¥å¿—é…ç½®ï¼š" class="headerlink" title="3ã€æ—¥å¿—é…ç½®ï¼š"></a>3ã€æ—¥å¿—é…ç½®ï¼š</h3><p><strong>æ—¥å¿—æ ¼å¼ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">log_formatÂ  mainÂ  &apos;$remote_addr - $remote_user [$time_local]   &quot;$request&quot; &apos;</span><br><span class="line">Â  Â  Â Â  Â  Â  Â  Â  Â  Â  Â  &apos;$status $body_bytes_sent &quot;$http_referer&quot; &apos;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  &apos;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&apos;;</span><br><span class="line">access_logÂ  logs/access.logÂ  main;</span><br><span class="line">#åŸºäºåŸŸåæ‰“å°æ—¥å¿—</span><br><span class="line">access_log logs/$host.access.log main;</span><br></pre></td></tr></table></figure></p>
<p><strong>erroræ—¥å¿—çš„è®¾ç½®</strong></p>
<p>è¯­æ³•ï¼šerror_log /path/file level;<br>é»˜è®¤ï¼šerror_log logs/error.log error;<br>levelæ˜¯æ—¥å¿—çš„è¾“å‡ºçº§åˆ«ï¼Œå–å€¼èŒƒå›´æ˜¯debugã€infoã€noticeã€warnã€errorã€critã€alertã€emerg.</p>
<p><strong>é’ˆå¯¹æŒ‡å®šçš„å®¢æˆ·ç«¯è¾“å‡ºdebugçº§åˆ«çš„æ—¥å¿—</strong><br>è¯­æ³•ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">debug_connection[IP|CIDR]</span><br><span class="line">events &#123;</span><br><span class="line">	debug_connection 192.168.0.147;Â </span><br><span class="line">	debug_connection 10.224.57.0/200;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><a href="https://attachments-cdn.shimo.im/fWYRhqhjvfIxcISK/nginx.conf" target="_blank" rel="noopener">nginx.conf</a></p>

    
  </div>

</article>


   
  <div class="text-center donation">
    <div class="inner-donation">
      <span class="btn-donation">Chat with me ğŸ¾</span>
      <div class="donation-body">
        <div class="tip text-center">Tell me when you add that you are from the blog</div>
        <ul>
        
          <li class="item">
            
            <img src="/images/WechatIMG5.jpeg" alt="">
          </li>
        
        </ul>
      </div>
    </div>
  </div>


   
  <div class="box-prev-next clearfix">
    <a class="show pull-left" href="/2018/09/19/Mybatis-è‡ªå®šä¹‰æ‹¦æˆªå™¨/">
        <i class="icon icon-angle-left"></i>
    </a>
    <a class="show pull-right" href="/2018/10/16/Nginx-æ€§èƒ½ä¼˜åŒ–å®è·µ/">
        <i class="icon icon-angle-right"></i>
    </a>
  </div>




</div>


  <a id="backTop" class="back-top">
    <i class="icon-angle-up"></i>
  </a>




  <div class="modal" id="modal">
  <span id="cover" class="cover hide"></span>
  <div id="modal-dialog" class="modal-dialog hide-dialog">
    <div class="modal-header">
      <span id="close" class="btn-close">å…³é—­</span>
    </div>
    <hr>
    <div class="modal-body">
      <ul class="list-toolbox">
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/archives/"
              rel="noopener noreferrer"
              target="_self"
              >
              åšå®¢
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/categories/"
              rel="noopener noreferrer"
              target="_self"
              >
              åˆ†ç±»
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/tag/"
              rel="noopener noreferrer"
              target="_self"
              >
              æ ‡ç­¾
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/link/"
              rel="noopener noreferrer"
              target="_self"
              >
              å‹é“¾
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/about/"
              rel="noopener noreferrer"
              target="_self"
              >
              å…³äº
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/atom.xml"
              rel="noopener noreferrer"
              target="_blank"
              >
              RSS
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/search/"
              rel="noopener noreferrer"
              target="_self"
              >
              æœç´¢
            </a>
          </li>
        
      </ul>

    </div>
  </div>
</div>



  
      <div class="fexo-comments comments-post">
    

    

    
    

    

    
    

    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src="//cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js"></script>
    <div id="comment" class="vcomment" ></div>
    <script>
        var notify = 'false' == true ? true : false;
        var verify = 'false' == true ? true : false;
        var GUEST_INFO = ['nick','mail','link'];
        var guest_info = 'nick,mail,link'.split(',').filter(function(item){
            return GUEST_INFO.indexOf(item) > -1
        });
        guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;
        window.valine = new Valine({
            el: '.vcomment',
            notify: notify,
            verify: verify,
            appId: "9cprXYUH7H1YKlRERiGS8bxV-gzGzoHsz",
            appKey: "et0Drv2jnj4ILMBUSaNM2M2R",
            avatar:'mm',
            placeholder: "Talk to me ^_^",
            guest_info:guest_info,
            pageSize:'10'
        });
    </script>
  
    

  </div>

  

  <script type="text/javascript">
  function loadScript(url, callback) {
    var script = document.createElement('script')
    script.type = 'text/javascript';

    if (script.readyState) { //IE
      script.onreadystatechange = function() {
        if (script.readyState == 'loaded' ||
          script.readyState == 'complete') {
          script.onreadystatechange = null;
          callback();
        }
      };
    } else { //Others
      script.onload = function() {
        callback();
      };
    }

    script.src = url;
    document.getElementsByTagName('head')[0].appendChild(script);
  }

  window.onload = function() {
    loadScript('/js/bundle.js?235683', function() {
      // load success
    });
  }
</script>

</body>
</html>
